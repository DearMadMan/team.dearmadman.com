<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="php," />










<meta name="description" content="PHP Standard Recommendations PSR 是 PHP Standard Recommendations 的简写，它是由 PHP FIG 组织制定的 PHP 规范，是 PHP 开发的实践标准。  序号 6：缓存接口规范缓存是提升应用性能的常用手段，为框架中最通用的功能，每个框架也都推出专属的、功能多样的缓存库。这些差别使得开发人员不得不学习多种系统，而很多可能是他们并不需要的">
<meta name="keywords" content="php">
<meta property="og:type" content="article">
<meta property="og:title" content="PSR 规范 —— PSR-6">
<meta property="og:url" content="http://yoursite.com/2016/05/07/the-PSR-6/index.html">
<meta property="og:site_name" content="Team.dearmadman.com">
<meta property="og:description" content="PHP Standard Recommendations PSR 是 PHP Standard Recommendations 的简写，它是由 PHP FIG 组织制定的 PHP 规范，是 PHP 开发的实践标准。  序号 6：缓存接口规范缓存是提升应用性能的常用手段，为框架中最通用的功能，每个框架也都推出专属的、功能多样的缓存库。这些差别使得开发人员不得不学习多种系统，而很多可能是他们并不需要的">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2017-09-13T15:23:23.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PSR 规范 —— PSR-6">
<meta name="twitter:description" content="PHP Standard Recommendations PSR 是 PHP Standard Recommendations 的简写，它是由 PHP FIG 组织制定的 PHP 规范，是 PHP 开发的实践标准。  序号 6：缓存接口规范缓存是提升应用性能的常用手段，为框架中最通用的功能，每个框架也都推出专属的、功能多样的缓存库。这些差别使得开发人员不得不学习多种系统，而很多可能是他们并不需要的">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2016/05/07/the-PSR-6/"/>





  <title>PSR 规范 —— PSR-6 | Team.dearmadman.com</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Team.dearmadman.com</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Just do it.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/07/the-PSR-6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dearmadman">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Team.dearmadman.com">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">PSR 规范 —— PSR-6</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-07T17:21:41+08:00">
                2016-05-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="PHP-Standard-Recommendations"><a href="#PHP-Standard-Recommendations" class="headerlink" title="PHP Standard Recommendations"></a>PHP Standard Recommendations</h1><blockquote>
<p>PSR 是 PHP Standard Recommendations 的简写，它是由 <a href="https://github.com/php-fig" target="_blank" rel="external">PHP FIG</a> 组织制定的 PHP 规范，是 PHP 开发的实践标准。</p>
</blockquote>
<h2 id="序号-6：缓存接口规范"><a href="#序号-6：缓存接口规范" class="headerlink" title="序号 6：缓存接口规范"></a>序号 6：缓存接口规范</h2><p>缓存是提升应用性能的常用手段，为框架中最通用的功能，每个框架也都推出专属的、功能多样的缓存库。这些差别使得开发人员不得不学习多种系统，而很多可能是他们并不需要的功能。此外，缓存库的开发者同样面临着一个窘境，是只支持有限数量的几个框架还是创建一堆庞大的适配器类。<br>一个通用的缓存系统接口可以解决掉这些问题。库和框架的开发人员能够知道缓存系统会按照他们所预期的方式工作，缓存系统的开发人员只需要实现单一的接口，而不用去开发各种各样的适配器。</p>
<h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><p>本 PSR 的目标是：创建一套通用的接口规范，能够让开发人员整合到现有框架和系统，而不需要去开发框架专属的适配器类。</p>
<h3 id="关于“能愿动词”的使用"><a href="#关于“能愿动词”的使用" class="headerlink" title="关于“能愿动词”的使用"></a>关于“能愿动词”的使用</h3><p>为了避免歧义，文档大量使用了“能愿动词”，对应的解释如下：</p>
<ul>
<li><code>必须（MUST）</code>：绝对，严格遵循，请照做，无条件遵守；</li>
<li><code>一定不可（MUST NOT）</code>：禁令，严令禁止；</li>
<li><code>应该（SHOULD）</code>：强烈建议这样做，但是不强求；</li>
<li><code>不该（SHOULD NOT）</code>：强烈不建议这样做，但是不强求；</li>
<li><code>可以（MAY）</code> 和 <code>可选（OPTIONAL）</code>：选择性高一点，在这个文档内，此词语使用较少；</li>
</ul>
<blockquote>
<p>参见：<a href="http://www.ietf.org/rfc/rfc2119.txt" target="_blank" rel="external">RFC 2119</a></p>
</blockquote>
<h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><ul>
<li><strong>调用类库（Calling Library）</strong>- 调用者，使用缓存服务的类库，这个类库调用缓存服务，调用的是此缓存接口规范的具体‘实现类库’，调用者不需要知道任何‘缓存服务’的具体实现。</li>
<li><strong>实现类库（Implementing Library）</strong> - 此类库是对‘缓存接口规范’的具体实现，封装起来的缓存服务，供’调用类库’。实现类库 <strong>必须</strong> 提供 PHP 类来实现 <code>Cache\CacheItemPoolInterface</code> 和 <code>Cache\CacheItemInterface</code> 接口。实现类库 <strong>必须</strong> 支持最小的如下描述的 TTL 功能，秒级别的精准度。</li>
<li>生存时间（TTL - Time To Live）- 定义了缓存可以存活的时间，以秒为单位的整数值。</li>
<li>过期时间（Expiration）- 定义准确的过期时间点，一般为缓存存储发生的时间点加上 TTL 时间值，也可以指定一个 DateTime 对象。<br>假如一个缓存项的 TTL 设置为 300 秒，保存于 1:30:00，那么缓存项的过期时间为 1:35:00。<br>实现类库 <strong>可以</strong> 让缓存项提前过期，但是 <strong>必须</strong> 在到达过期时间时立即把缓存项标示为过期。如果调用类库在保存一个缓存项的时候未设置‘过期时间’、或者设置了 <code>null</code> 作为过期时间（或者 TTL 设置为 <code>null</code>），实现类库 <strong>可以</strong> 使用默认自行配置的一个时间。如果没有默认时间，实现类库 <strong>必须</strong> 把存储时间当做 <code>永久性</code> 存储，或者按照底层驱动能支持的最长时间作为保存时间。</li>
<li><strong>键（KEY）</strong> - 长度大于 1 的字符串，用作缓存项在缓存系统里的唯一标示。实现类库 <strong>必须</strong> 支持‘键’规则 <code>A-Z</code>、<code>a-z</code>、<code>0-9</code>、<code>_</code>、和 <code>.</code> 任何顺序的 UTF-8 编码，长度小于 64 位。实现类库 <strong>可以</strong> 支持更多的编码或者更长的长度，不过 <strong>必须</strong> 支持至少以上指定的编码和长度。实现类库可自行实现对‘键’的转义，但是 <strong>必须</strong> 保证能够无损的返回‘键’字串。以下的字串作为系统保留：<code>{}()/\@:</code>，<strong>一定不可</strong> 作为‘键’的命名支持。</li>
<li><strong>命中（Hit）</strong> - 一个缓存的命中，指的是当调用类库使用‘键’在请求一个缓存项的时候，在缓存池里能找到对应的缓存项，并且此缓存项还未过期，并且此数据不会因为任何原因出现错误。调用类库 <strong>应该</strong> 确保先验证下 <code>isHit()</code> 有命中后才调用 <code>get()</code> 获取数据。</li>
<li><strong>未命中（Miss）</strong> - 一个缓存未命中，是完全的上面描述的‘命中’的相反。指的是当调用类库使用‘键’在请求一个缓存项的时候，在缓存池里未能找到对应的缓存项，或者此缓存项已经过期，或者此数据因为任何原因出现错误。一个过期的缓存项，<strong>必须</strong> 被当做 <code>未命中</code> 来对待。</li>
<li><strong>延迟（Deferred）</strong> - 一个延迟的缓存，指的是这个缓存项可能不会立刻被存储到物理缓存池里。一个缓存池对象 <strong>可以</strong> 对一个指定延迟的缓存项进行延迟存储，这样做的好处是可以利用一些缓存服务器提供的批量插入功能。缓存池 <strong>必须</strong> 能对所有延迟缓存最终能持久化，并且不会丢失。<strong>可以</strong> 在调用类库还未发起保存请求之前就做持久化。当调用类库调用 <code>commit()</code> 方法时，所有的延迟缓存都 <strong>必须</strong> 做持久化。实现类库 <strong>可以</strong> 自行决定使用什么逻辑来触发数据持久化，如对象的 <code>析构方法（destructor）</code>内、调用 <code>save()</code> 时持久化、倒计时保存或者触发及最大数量时保存等。当请求一个延迟缓存项时，<strong>必须</strong> 返回一个延迟，未持久化的缓存对象。</li>
</ul>
<h3 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h3><p>实现类库 <strong>必须</strong> 支持所有的可序列化的 PHP 数据类型，包括：</p>
<ul>
<li><strong>字符串</strong> - 任何大小的 PHP 兼容字符串</li>
<li><strong>整数</strong> - PHP 支持的低于 64 位的有符号整数值</li>
<li><strong>浮点数</strong> - 所有的有符号浮点数</li>
<li><strong>布尔</strong> - true 和 false</li>
<li><strong>Null</strong> - <code>null</code> 值</li>
<li><strong>数组</strong> - 各种形式的 PHP 数组</li>
<li><strong>对象（Object）</strong> - 所有的支持无损序列化和反序列化的对象，如： <code>$o == unserialize(serialize($o))</code>。对象 <strong>可以</strong> 使用 PHP 的 <code>Serializeable</code> 接口，<code>__sleep()</code> 或者 <code>__wakeup()</code> 魔术方法，或者在合适的情况下，使用其他类似的语言特性。</li>
</ul>
<p>所有存进实现类库的数据，都 <code>必须</code> 能做到原封不动的取出。连类型也 <strong>必须</strong> 是完全一致，如果存进缓存的是字符串 5，取出来的却是整数值 5 的话，可以算作严重的错误。实现类库 <strong>可以</strong> 使用 PHP 的 ‘serialize()/unserialize()’ 方法作为底层的实现，不过不强迫这样做。对于他们的兼容性，以能支持所有数据类型作为基准线。<br>实在无法‘完整取出’存入的数据的话，实现类库 <strong>必须</strong> 把‘缓存丢失’标识作为返回，而不是损坏了的数据。</p>
<h2 id="主要概念"><a href="#主要概念" class="headerlink" title="主要概念"></a>主要概念</h2><h3 id="缓存池-Pool"><a href="#缓存池-Pool" class="headerlink" title="缓存池 Pool"></a>缓存池 Pool</h3><p>缓存池包含缓存系统里所有缓存数据的集合。缓存池逻辑上是所有缓存项存储的仓库，所有存储进去的数据，都能从缓存池里取出来，所有的对缓存的操作，都发生在缓存池子里。</p>
<h3 id="缓存项-Items"><a href="#缓存项-Items" class="headerlink" title="缓存项 Items"></a>缓存项 Items</h3><p>一条缓存项在缓存池里代表了一对‘键值’对应的数据，‘键’被视为每一个缓存项的主键，是缓存项的唯一标识符，<strong>必须</strong> 是不可变更的，当然‘值’<strong>可以</strong> 任意变更。</p>
<h3 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h3><p>缓存对应性能起着至关重要的作用，但是，无论在任何情况下，缓存 <strong>一定不可</strong> 作为应用程序不可或缺的核心功能。<br>缓存系统里的错误 <strong>一定不可</strong> 导致应用程序故障，所以类库 <strong>一定不可</strong> 抛出任何除了此接口规范定义的以外的异常，并且 <strong>必须</strong> 捕获包括底层存储驱动抛出的异常，不让其冒泡至超出缓存系统内。<br>实现类库 <strong>应该</strong> 对此类错误进行记录，或者以任何形式通知管理员。<br>调用类库发起删除缓存的请求，或者清空整个缓冲池子的请求，‘键’不存在的话 <strong>必须</strong> 不能当成是有错误发生。后置条件是一样的，如果取数据时，‘键’不存在的话 <strong>必须</strong> 不能当成是有错误发生。</p>
<h3 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h3><p><code>CacheIemInterface</code> 定义了缓存系统里的一个缓存项。每一个缓存项 <strong>必须</strong> 有一个‘键’与之相关联，此‘键’通常是通过 Cache\CacheItemPoolInterface 来设置。<br>Cache\CacheItemInterface 对象把缓存项的存储进行了封装，每一个 Cache\CacheItemInterface 由一个 Cache\CacheItemPoolInterface 对象生成，CacheItemPoolInterface 负责一些必须的设置，并且给对象设置具有 <code>唯一性</code> 的‘键’。<br>Cache\CacheItemInterface 对象 <strong>必须</strong> 能够存储和取出任何数据，在‘数据’章节定义的 PHP 的数值。<br>调用类库 <strong>一定不可</strong> 擅自初始化 ‘CacheItemInterface’ 对象，‘缓存项’只能使‘CacheItemPoolInterface’对象的 <code>getItem()</code> 方法来获取。调用类库 <strong>一定不可</strong> 假设由一个实现类库创建的‘缓存项’能被另一个实现类库完全兼容。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">namespace</span> <span class="title">Psr</span>\<span class="title">Cache</span>;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * CacheItemInterface 定了缓存系统里对缓存项操作的接口</span></div><div class="line"><span class="comment"> */</span></div><div class="line"> <span class="class"><span class="keyword">interface</span> <span class="title">CacheItemInterface</span></span></div><div class="line"><span class="class"> </span>&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * 返回当前缓存项的‘键’</span></div><div class="line"><span class="comment">     *</span></div><div class="line"><span class="comment">     * ‘键’由实现类库来加载，并且高层的调用者（如：CacheItemPoolInterface）</span></div><div class="line"><span class="comment">     * **应该** 能使用此方法来获取到‘键’的信息</span></div><div class="line"><span class="comment">     *</span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span> string 当前缓存项的‘键’</span></div><div class="line"><span class="comment">     */</span></div><div class="line">     <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getKey</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">     <span class="comment">/**</span></div><div class="line"><span class="comment">      * 凭借此缓存项的‘键’从缓存系统里面取出缓存项。</span></div><div class="line"><span class="comment">      *</span></div><div class="line"><span class="comment">      * 取出的数据 **必须** 跟使用 `set()` 存进去的数据是一模一样的。</span></div><div class="line"><span class="comment">      * </span></div><div class="line"><span class="comment">      * 如果 `isHit()` 返回 false 的话，此方法必须返回 `null`，需要注意的是 `null`</span></div><div class="line"><span class="comment">      * 本来就是一个合法的缓存数据，所以你 **应该** 使用 `isHit()` 方法来判别到底是</span></div><div class="line"><span class="comment">      * ‘返回 null 的数据’还是‘缓存里没有此数据’。</span></div><div class="line"><span class="comment">      *</span></div><div class="line"><span class="comment">      * <span class="doctag">@return</span> mixed 此缓存项的‘键’对应的‘值’，如果找不到的话，返回 `null`</span></div><div class="line"><span class="comment">      */</span></div><div class="line">     <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">     <span class="comment">/**</span></div><div class="line"><span class="comment">      * 确认缓存项的检查是否命中。</span></div><div class="line"><span class="comment">      *</span></div><div class="line"><span class="comment">      * 注意：调用此方法和调用 `get()` 时 **一定不可** 有先后顺序之分。</span></div><div class="line"><span class="comment">      *</span></div><div class="line"><span class="comment">      * <span class="doctag">@return</span> bool 如果缓冲池里有命中的话，返回 `true`，反之返回 `false`</span></div><div class="line"><span class="comment">      */</span></div><div class="line">      <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isHit</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">      <span class="comment">/**</span></div><div class="line"><span class="comment">       * 为此缓存项设置‘值’</span></div><div class="line"><span class="comment">       *</span></div><div class="line"><span class="comment">       * 参数 $value 可以是所有能被 PHP 序列化的数据，序列化的逻辑</span></div><div class="line"><span class="comment">       * 需要在实现类库里书写。</span></div><div class="line"><span class="comment">       * </span></div><div class="line"><span class="comment">       * <span class="doctag">@param</span> mixed $value 将被存储的可序列化的数据。</span></div><div class="line"><span class="comment">       * <span class="doctag">@return</span> 返回当前对象</span></div><div class="line"><span class="comment">       */</span></div><div class="line">       <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">set</span><span class="params">($value)</span></span>;</div><div class="line"></div><div class="line">       <span class="comment">/**</span></div><div class="line"><span class="comment">        * 设置缓存项的准确过期时间点。</span></div><div class="line"><span class="comment">        *</span></div><div class="line"><span class="comment">        * <span class="doctag">@param</span> \DateTimeInterface $expiration</span></div><div class="line"><span class="comment">        *</span></div><div class="line"><span class="comment">        * 过期的准确时间点，过了这个时间点后，缓存项就 **必须** 被认为是过期了的。</span></div><div class="line"><span class="comment">        * 如果明确的传参 `null` 的话， **可以** 使用一个默认的时间。</span></div><div class="line"><span class="comment">        * 如果没有设置的话，缓存 **应该** 存储到底层实现的最大化允许时间。</span></div><div class="line"><span class="comment">        * </span></div><div class="line"><span class="comment">        * <span class="doctag">@return</span> static 返回当前对象</span></div><div class="line"><span class="comment">        */</span></div><div class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">expiresAt</span><span class="params">($expiration)</span></span>;</div><div class="line"></div><div class="line">        <span class="comment">/**</span></div><div class="line"><span class="comment">         * 设置缓存项的过期时间。</span></div><div class="line"><span class="comment">         * </span></div><div class="line"><span class="comment">         * <span class="doctag">@param</span> int | \DateInterval $time</span></div><div class="line"><span class="comment">         *  以秒为单位的过期时长，过了这段时间后，缓存项就 **必须** 被认为是过期了的。</span></div><div class="line"><span class="comment">         *  如果明确的传参 `null` 的话， **可以** 使用一个默认的时间。</span></div><div class="line"><span class="comment">         *  如果没有设置的话，缓存 **应该** 存储到底层实现的最大允许时间。</span></div><div class="line"><span class="comment">         *</span></div><div class="line"><span class="comment">         *  <span class="doctag">@return</span> static 返回当前对象</span></div><div class="line"><span class="comment">         */</span></div><div class="line">         <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">expiresAfter</span><span class="params">($time)</span></span>;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h3 id="CacheItemPoolInterface"><a href="#CacheItemPoolInterface" class="headerlink" title="CacheItemPoolInterface"></a>CacheItemPoolInterface</h3><p>Cache\CacheItemPoolInterface 的主要目的是从调用类库接收‘键’，然后返回对应的 Cache\CacheItemInterface 对象。<br>此接口也是作为主要的，与整个缓存集合交互的方式。所有的配置和初始化由实现类库自行实现。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">namespace</span> <span class="title">Psr</span>\<span class="title">Cache</span>;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * CacheItemPoolInterface 生成 CacheItemInterface 对象</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">CacheItemPoolInterface</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * 返回‘键’对应的一个缓存项。</span></div><div class="line"><span class="comment">     *</span></div><div class="line"><span class="comment">     * 此方法 **必须** 返回一个 CacheItemInterface 对象，即使是找不到对应的缓存项</span></div><div class="line"><span class="comment">     * 也 **一定不可** 返回 `null`。</span></div><div class="line"><span class="comment">     *</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> string $key 用来搜索缓存项的‘键’</span></div><div class="line"><span class="comment">     * <span class="doctag">@throws</span> InvalidAraumentException</span></div><div class="line"><span class="comment">     *   如果 $key 不是合法的值，\Psr\Cache\InvalidArgumentException 异常会被抛出。</span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span> CacheItemInterface 对应的缓存想</span></div><div class="line"><span class="comment">     */</span></div><div class="line">     <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getItem</span><span class="params">($key)</span></span>;</div><div class="line"></div><div class="line">     <span class="comment">/**</span></div><div class="line"><span class="comment">      * 返回一个可供遍历的缓存项集合。</span></div><div class="line"><span class="comment">      * </span></div><div class="line"><span class="comment">      * <span class="doctag">@param</span> array $keys 由一个或多个‘键’组成的数组。</span></div><div class="line"><span class="comment">      *</span></div><div class="line"><span class="comment">      * <span class="doctag">@throw</span> InvalidArgumentException</span></div><div class="line"><span class="comment">      *   如果 $keys 里面有哪个‘键’不合法，\Psr\Cache\InvalidArgumentException 异常会被抛出。</span></div><div class="line"><span class="comment">      *</span></div><div class="line"><span class="comment">      * <span class="doctag">@return</span> array | \Traversable</span></div><div class="line"><span class="comment">      *   返回一个可供遍历的缓存项集合，集合里每个元素的标识符由‘键’组成，即使是找不到对的</span></div><div class="line"><span class="comment">      *   缓存项，也要返回一个‘CacheItemInterface’对象到对应的‘键’中。</span></div><div class="line"><span class="comment">      *   如果传参的数组为空，也需要返回一个空的可遍历的集合。</span></div><div class="line"><span class="comment">      */</span></div><div class="line">      <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getItems</span><span class="params">(array $keys = array<span class="params">()</span>)</span></span>;</div><div class="line"></div><div class="line">      <span class="comment">/**</span></div><div class="line"><span class="comment">       * 检查缓存系统中是否有‘键’对应的缓存项。</span></div><div class="line"><span class="comment">       * </span></div><div class="line"><span class="comment">       * 注意：此方法应该调用 `CacheItemInterface::isHit()` 来做操作检查，而不是</span></div><div class="line"><span class="comment">       * `CacheItemInterface::get()`</span></div><div class="line"><span class="comment">       *</span></div><div class="line"><span class="comment">       * <span class="doctag">@param</span> string $key 用来搜索缓存项的‘键’。</span></div><div class="line"><span class="comment">       *</span></div><div class="line"><span class="comment">       * <span class="doctag">@throws</span> InvalidArgumentException</span></div><div class="line"><span class="comment">       *  如果 $key 不是合法的值，\Psr\Cache\InvalidArgumentException 异常会被抛出。</span></div><div class="line"><span class="comment">       *</span></div><div class="line"><span class="comment">       * <span class="doctag">@return</span> bool 如果存在‘键’对应的缓存项即返回 true, 否则 false</span></div><div class="line"><span class="comment">       */</span></div><div class="line">      <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">hasItem</span><span class="params">($key)</span></span>;</div><div class="line"></div><div class="line">      <span class="comment">/**</span></div><div class="line"><span class="comment">       * 清空缓冲池</span></div><div class="line"><span class="comment">       *</span></div><div class="line"><span class="comment">       * <span class="doctag">@return</span> bool 成果返回 true，有错误发生返回 false</span></div><div class="line"><span class="comment">       */</span></div><div class="line">       <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">clear</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">       <span class="comment">/**</span></div><div class="line"><span class="comment">        * 从缓冲池里移除某个缓存项</span></div><div class="line"><span class="comment">        *</span></div><div class="line"><span class="comment">        * <span class="doctag">@param</span> string $key 用来搜索缓存项的‘键’</span></div><div class="line"><span class="comment">        *</span></div><div class="line"><span class="comment">        * <span class="doctag">@throws</span> InvalidArgumentException</span></div><div class="line"><span class="comment">        *    如果 $key 不是合法的值，\Psr\Cache\InvalidArgumentException 异常会被抛出。</span></div><div class="line"><span class="comment">        *</span></div><div class="line"><span class="comment">        * <span class="doctag">@return</span> bool 成功返回 true，有错误发生返回 false</span></div><div class="line"><span class="comment">        */</span></div><div class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">deleteItem</span><span class="params">($key)</span></span>;</div><div class="line"></div><div class="line">        <span class="comment">/**</span></div><div class="line"><span class="comment">         * 从缓冲池里移除多个缓存项</span></div><div class="line"><span class="comment">         *</span></div><div class="line"><span class="comment">         * <span class="doctag">@param</span> array $keys 由一个或者多个‘键’组成的数组。</span></div><div class="line"><span class="comment">         *</span></div><div class="line"><span class="comment">         * <span class="doctag">@throws</span> InvalidArgumentException</span></div><div class="line"><span class="comment">         *   如果 $keys 里面有哪个‘键’不是合法，\Psr\Cache\InvalidArgumentException 异常会被抛出</span></div><div class="line"><span class="comment">         * <span class="doctag">@return</span> bool 成功返回 true，有错误发生返回 false</span></div><div class="line"><span class="comment">         */</span></div><div class="line">         <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">deleteItems</span><span class="params">(array $keys)</span></span>;</div><div class="line"></div><div class="line">         <span class="comment">/**</span></div><div class="line"><span class="comment">          * 立刻为 ‘CacheItemInterface' 对象做数据持久化。</span></div><div class="line"><span class="comment">          * </span></div><div class="line"><span class="comment">          * <span class="doctag">@param</span> CacheItemInterface $item 将要被存储的缓存项</span></div><div class="line"><span class="comment">          *</span></div><div class="line"><span class="comment">          * <span class="doctag">@return</span> bool 成功返回 true，有错误发生返回 false</span></div><div class="line"><span class="comment">          */</span></div><div class="line">          <span class="keyword">public</span> funciton save(CacheItemInterface $item);</div><div class="line"></div><div class="line">          <span class="comment">/**</span></div><div class="line"><span class="comment">           * 稍后为 ‘CacheItemInterface’ 对象做数据持久化。</span></div><div class="line"><span class="comment">           *</span></div><div class="line"><span class="comment">           * <span class="doctag">@param</span> CacheItemInterface $item 将要被存储的缓存项</span></div><div class="line"><span class="comment">           *</span></div><div class="line"><span class="comment">           * <span class="doctag">@return</span> bool 成功返回 true，有错误发生返回 false</span></div><div class="line"><span class="comment">           */</span></div><div class="line">           <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">saveDeferred</span><span class="params">(CacheItemInterface $item)</span></span>;</div><div class="line"></div><div class="line">           <span class="comment">/**</span></div><div class="line"><span class="comment">            * 提交所有的正在队列里等待的请求到数据持久层，配合 `saveDeferred()` 使用</span></div><div class="line"><span class="comment">            *</span></div><div class="line"><span class="comment">            * <span class="doctag">@return</span> bool 成功返回 true，有错误发生返回 false</span></div><div class="line"><span class="comment">            */</span></div><div class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">commit</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="CacheException"><a href="#CacheException" class="headerlink" title="CacheException"></a>CacheException</h3><p>此异常用于缓存系统发生的多有严重错误，包括但不限制于 <strong>缓存系统配置</strong>，如连接到缓存服务器出错、错误的用户身份认证等。<br>多有的实现类库抛出的异常都 <strong>必须</strong> 实现此接口。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">namespace</span> <span class="title">Psr</span>\<span class="title">Cache</span>;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * 被所有的实现类库抛出的异常继承‘异常接口’</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">CacheException</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="InvalidArgumentException"><a href="#InvalidArgumentException" class="headerlink" title="InvalidArgumentException"></a>InvalidArgumentException</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">namespace</span> <span class="title">Psr</span>\<span class="title">Cache</span>;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * 传参错误抛出的异常接口</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * 当一个错误或者非法的传参发生时， **必须** 抛出一个继承了</span></div><div class="line"><span class="comment"> * Psr\Cache\InvalidArgumentException 的异常。</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">InvalidArgumentException</span> <span class="keyword">extends</span> <span class="title">CacheException</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>来自：<a href="https//psr.phphub.org">https://psr.phphub.org</a></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/php/" rel="tag"># php</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/05/07/the-PSR-4/" rel="next" title="PSR 规范 —— PSR-4">
                <i class="fa fa-chevron-left"></i> PSR 规范 —— PSR-4
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/05/07/the-PSR-7/" rel="prev" title="the PSR-7">
                the PSR-7 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Dearmadman</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">100</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#PHP-Standard-Recommendations"><span class="nav-number">1.</span> <span class="nav-text">PHP Standard Recommendations</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#序号-6：缓存接口规范"><span class="nav-number">1.1.</span> <span class="nav-text">序号 6：缓存接口规范</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#目标"><span class="nav-number">1.2.</span> <span class="nav-text">目标</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#关于“能愿动词”的使用"><span class="nav-number">1.2.1.</span> <span class="nav-text">关于“能愿动词”的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#定义"><span class="nav-number">1.2.2.</span> <span class="nav-text">定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据"><span class="nav-number">1.2.3.</span> <span class="nav-text">数据</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#主要概念"><span class="nav-number">1.3.</span> <span class="nav-text">主要概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#缓存池-Pool"><span class="nav-number">1.3.1.</span> <span class="nav-text">缓存池 Pool</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#缓存项-Items"><span class="nav-number">1.3.2.</span> <span class="nav-text">缓存项 Items</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#错误处理"><span class="nav-number">1.3.3.</span> <span class="nav-text">错误处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#接口"><span class="nav-number">1.3.4.</span> <span class="nav-text">接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CacheItemPoolInterface"><span class="nav-number">1.3.5.</span> <span class="nav-text">CacheItemPoolInterface</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CacheException"><span class="nav-number">1.3.6.</span> <span class="nav-text">CacheException</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#InvalidArgumentException"><span class="nav-number">1.3.7.</span> <span class="nav-text">InvalidArgumentException</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Dearmadman</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
