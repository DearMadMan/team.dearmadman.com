<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Team.dearmadman.com">
<meta property="og:url" content="http://yoursite.com/page/9/index.html">
<meta property="og:site_name" content="Team.dearmadman.com">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Team.dearmadman.com">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/9/"/>





  <title>Team.dearmadman.com</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Team.dearmadman.com</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Just do it.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/07/the-PSR-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dearmadman">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Team.dearmadman.com">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/05/07/the-PSR-4/" itemprop="url">PSR 规范 —— PSR-4</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-07T17:21:31+08:00">
                2016-05-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="PHP-Standard-Recommendations"><a href="#PHP-Standard-Recommendations" class="headerlink" title="PHP Standard Recommendations"></a>PHP Standard Recommendations</h1><blockquote>
<p>PSR 是 PHP Standard Recommendations 的简写，它是由 <a href="https://github.com/php-fig" target="_blank" rel="external">PHP FIG</a> 组织制定的 PHP 规范，是 PHP 开发的实践标准。</p>
</blockquote>
<h2 id="序号-4：自动加载规范"><a href="#序号-4：自动加载规范" class="headerlink" title="序号 4：自动加载规范"></a>序号 4：自动加载规范</h2><p>本 PSR 是关于由文件路径 <a href="http://php.net/autoload" target="_blank" rel="external">自动加载</a> 对应类的相关规范，本规范是可互操作的，可以作为任一自动载入规范的补充，其中包括 PSR-0（已废弃），此外，本 PSR 还包括自动载入的类对应的文件存放路径规范。</p>
<h3 id="关于“能愿动词”的使用"><a href="#关于“能愿动词”的使用" class="headerlink" title="关于“能愿动词”的使用"></a>关于“能愿动词”的使用</h3><p>为了避免歧义，文档大量使用了“能愿动词”，对应的解释如下：</p>
<ul>
<li><code>必须（MUST）</code>：绝对，严格遵循，请照做，无条件遵守；</li>
<li><code>一定不可（MUST NOT）</code>：禁令，严令禁止；</li>
<li><code>应该（SHOULD）</code>：强烈建议这样做，但是不强求；</li>
<li><code>不该（SHOULD NOT）</code>：强烈不建议这样做，但是不强求；</li>
<li><code>可以（MAY）</code> 和 <code>可选（OPTIONAL）</code>：选择性高一点，在这个文档内，此词语使用较少；</li>
</ul>
<blockquote>
<p>参见：<a href="http://www.ietf.org/rfc/rfc2119.txt" target="_blank" rel="external">RFC 2119</a></p>
</blockquote>
<h3 id="详细说明"><a href="#详细说明" class="headerlink" title="详细说明"></a>详细说明</h3><p>1.此处的‘类’泛指所有的‘class 类’、‘接口’、‘traits 可复用代码块’以及其它类似结构。<br>2.一个完整的类名需要具备以下结构</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\&lt;命名空间&gt;(\&lt;子命名空间&gt;)*\&lt;类名&gt;</div></pre></td></tr></table></figure>
<ul>
<li>完整的类名 <strong>必须</strong> 要有一个顶级命名空间，被称为 ‘vendor namespace’</li>
<li>完整的类名 <strong>可以</strong> 有一个或多个子命名空间</li>
<li>完整的类名 <strong>必须</strong> 有一个最终的类名</li>
<li>完整的类名中任意一部分中的下划线都是没有特殊含义的</li>
<li>完整的类名 <strong>可以</strong> 由任意大小写字母组成</li>
<li>所有类名都 <strong>必须</strong> 是大小写敏感的。</li>
</ul>
<p>3.当根据完整的类名载入相应的文件</p>
<ul>
<li>完整的类名中，去掉最前面的命名空间分隔符，前面连续的一个或多个命名空间和子命名空间，作为‘命名空间前缀’，其必须与至少一个‘文件基目录’相对应。</li>
<li>紧接命名空间前缀后的子命名空间 <strong>必须</strong> 与相应的‘文件基目录’相匹配，其命名空间分隔符将作为目录分隔符。</li>
<li>末尾的类名 <strong>必须</strong> 与对应的以 <code>.php</code> 为后缀的文件同名。</li>
<li>自动加载器（autoloader）的实现 <strong>一定不可</strong> 抛出异常、<strong>一定不可</strong> 触发任一级别的错误信息以及 <strong>不应该</strong> 有返回值。</li>
</ul>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><p>下表展示了符合规范完整类名、命名空间前缀和文件基目录所对应的文件路径。</p>
<table>
<thead>
<tr>
<th>完整类名</th>
<th>命名空间前缀</th>
<th>文件基目录</th>
<th>文件路径</th>
</tr>
</thead>
<tbody>
<tr>
<td>\Acme\Log\Writer\File_Writer</td>
<td>Acme\Log\Writer</td>
<td>./acme-log-writer/lib/</td>
<td>./acme-log-writer/lib/File_Writer.php</td>
</tr>
<tr>
<td>\Aura\Web\Response\Status</td>
<td>Aura\Web</td>
<td>/path/to/aura-web/src/</td>
<td>/path/to/aura-web/src/Response/Status.php</td>
</tr>
<tr>
<td>\Symfony\Core\Request</td>
<td>Symfony\Core</td>
<td>./vendor/Symfony/Core/</td>
<td>./vendor/Symfony/Core/Request.php</td>
</tr>
<tr>
<td>\Zend\Acl</td>
<td>Zend</td>
<td>/usr/includes/Zend/</td>
<td>/usr/includes/Zend/Acl.php</td>
</tr>
</tbody>
</table>
<p>关于本规范的实现，可参阅 <a href="https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-4-autoloader-examples.md" target="_blank" rel="external">相关实例</a></p>
<blockquote>
<p>注意： 实例并 <strong>不</strong> 属于规范的一部分，且随时 <strong>会</strong> 有所变动。</p>
</blockquote>
<p>来自：<a href="https//psr.phphub.org">https://psr.phphub.org</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/07/the-PSR-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dearmadman">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Team.dearmadman.com">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/05/07/the-PSR-3/" itemprop="url">PSR 规范 —— PSR-3</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-07T17:21:22+08:00">
                2016-05-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="PHP-Standard-Recommendations"><a href="#PHP-Standard-Recommendations" class="headerlink" title="PHP Standard Recommendations"></a>PHP Standard Recommendations</h1><blockquote>
<p>PSR 是 PHP Standard Recommendations 的简写，它是由 <a href="https://github.com/php-fig" target="_blank" rel="external">PHP FIG</a> 组织制定的 PHP 规范，是 PHP 开发的实践标准。</p>
</blockquote>
<h2 id="序号-3：日志接口规范"><a href="#序号-3：日志接口规范" class="headerlink" title="序号 3：日志接口规范"></a>序号 3：日志接口规范</h2><p>本文制定了日志类库的通用接口规范。<br>本规范的主要目的，是为了让日志类库以简单通用的方式，通过接收一个 <code>Psr\Log\LoggerInterface</code> 对象，来记录日志信息。框架以及 CMS 内容管理系统如有需要， <strong>可以</strong> 对此接口进行扩展，但需要遵循本规范，这才能保证在使用第三方类库文件时，日志接口仍能正常对接。</p>
<h3 id="关于“能愿动词”的使用"><a href="#关于“能愿动词”的使用" class="headerlink" title="关于“能愿动词”的使用"></a>关于“能愿动词”的使用</h3><p>为了避免歧义，文档大量使用了“能愿动词”，对应的解释如下：</p>
<ul>
<li><code>必须（MUST）</code>：绝对，严格遵循，请照做，无条件遵守；</li>
<li><code>一定不可（MUST NOT）</code>：禁令，严令禁止；</li>
<li><code>应该（SHOULD）</code>：强烈建议这样做，但是不强求；</li>
<li><code>不该（SHOULD NOT）</code>：强烈不建议这样做，但是不强求；</li>
<li><code>可以（MAY）</code> 和 <code>可选（OPTIONAL）</code>：选择性高一点，在这个文档内，此词语使用较少；</li>
</ul>
<blockquote>
<p>参见：<a href="http://www.ietf.org/rfc/rfc2119.txt" target="_blank" rel="external">RFC 2119</a></p>
</blockquote>
<h3 id="规范说明"><a href="#规范说明" class="headerlink" title="规范说明"></a>规范说明</h3><h4 id="基本规范"><a href="#基本规范" class="headerlink" title="基本规范"></a>基本规范</h4><ul>
<li><code>LoggerInterface</code> 接口对外定义了八个方法，分别用来记录 <a href="http://tools.ietf.org/html/rfc5424" target="_blank" rel="external">RFC 5424</a> 中定义的八个等级的日志：debug、info、notice、warning、error、critical、alert 以及 emergency。</li>
<li>第九个方法 —— <code>log</code>，其第一个参数为记录的等级。可使用一个预先定义的等级常量作为参数来调用此方法，<strong>必须</strong> 与直接调用以上八个方法具有相同的效果。如果传入的等级常量参数没有预先定义，则 <strong>必须</strong> 抛出 <code>Psr\Log\InvalidArgumentException</code> 类型的异常。在不确定的情况下，使用者 <strong>不该</strong> 使用未支持的等级常量来调用此方法。</li>
</ul>
<h4 id="记录信息"><a href="#记录信息" class="headerlink" title="记录信息"></a>记录信息</h4><ul>
<li>以上每个方法都接受一个字符串类型或者是有 <code>toString()</code> 方法的对象作为记录信息参数，这样，实现者就能把它当成字符串来处理，否则实现者 <strong>必须</strong> 自己把它转换成字符串。</li>
<li>记录信息参数 <strong>可以</strong> 携带占位符，实现者 <strong>可以</strong> 根据上下文将其它替换成相应的值。</li>
</ul>
<p>其中占位符 <strong>必须</strong> 与上下文数组中的键名保持一致。<br>占位符的名称 <strong>必须</strong> 由一个左花括号 <code>{</code> 以及一个右花括号 <code>}</code> 包含。但花括号与名称之间 <strong>一定不可</strong>有空格符。<br>占位符的名称 <strong>应该</strong> 只由 <code>A-Z</code>、<code>a-z</code>、<code>0-9</code>、下划线 <code>_</code>、以及英文的句号 <code>.</code> 组成，其它字符作为将来占位符规范的保留。</p>
<p>实现者 <strong>可以</strong> 通过对占位符采用不同的转义和转换策略，来生成最终的日志。而使用者在不知道上下文的前提下，<strong>不该</strong> 提前转义占位符。</p>
<p>以下是一个占位符使用的例子：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * 用上下文信息替换记录信息中的占位符</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">interpolate</span><span class="params">($message, array $context = array<span class="params">()</span>)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="comment">// 构建一个花括号包含的键名的替换数组</span></div><div class="line">    $replace = <span class="keyword">array</span>();</div><div class="line">    <span class="keyword">foreach</span> ($context <span class="keyword">as</span> $key =&gt; $val) &#123;</div><div class="line">        $replace[<span class="string">'&#123;'</span> . $key . <span class="string">'&#125;'</span>] = $val;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// 替换记录信息中的占位符，最后返回修改后的记录信息。</span></div><div class="line">    <span class="keyword">return</span> strtr($message, $replace);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 含有带花括号占位符的记录信息</span></div><div class="line">$message = <span class="string">"User &#123;username&#125; created"</span>;</div><div class="line"></div><div class="line"><span class="comment">// 带有替换信息的上下文数组，键名为占位符名称，键值为替换值。</span></div><div class="line">$context = <span class="keyword">array</span>(<span class="string">'username'</span> =&gt; <span class="string">'boivar'</span>);</div><div class="line"></div><div class="line"><span class="comment">// 输出 "Username bolivar created"</span></div><div class="line"><span class="keyword">echo</span> interpolate($message, $context)</div></pre></td></tr></table></figure>
<h4 id="上下文"><a href="#上下文" class="headerlink" title="上下文"></a>上下文</h4><ul>
<li>每个记录函数都接受一个上下文数组参数，用来装载字符串类型无法表示的信息。它 <strong>可以</strong> 装载任何信息，所以实现者 <strong>必须</strong> 确保能正确处理其装载的信息，对于其装载的数据，<strong>一定不可</strong> 抛出异常，或产生 PHP 出错、警告或提醒信息（error、warning、notice）。</li>
<li>如需通过上下文参数传入了一个 <code>Exception</code> 对象，<strong>必须</strong> 以 <code>exception</code> 作为键名。记录异常信息是很普遍的，所以如果它能够在记录类库的底层实现，就能够让实现者从异常信息中抽丝剥茧。当然，实现者在使用它时，<strong>必须</strong>确保键名为 <code>exception</code> 的键值是否真的是一个 <code>Exception</code>，毕竟它 <strong>可以</strong> 装载任何信息。</li>
</ul>
<h4 id="助手类和接口"><a href="#助手类和接口" class="headerlink" title="助手类和接口"></a>助手类和接口</h4><ul>
<li><code>Psr\Log\AbstractLogger</code> 类使得只需要继承它和实现其中的 <code>log</code> 方法，就能够很轻易地实现 <code>LoggerInterface</code> 接口，而另外八个方法就能够把记录信息和上下文信息传递给它。</li>
<li>同样的，使用 <code>Psr\Log\LoggerTrait</code> 也只需实现其中的 <code>log</code> 方法。不过，需要特别注意的是，在 traits 可复用代码块还不能实现接口前，还需要 <code>implement LoggerInterface</code>。</li>
<li>在没有可用的日志记录器时，<code>Psr\Log\NullLogger</code> 接口 <strong>可以</strong> 为使用者提供一个备用的日志‘黑洞’。不过，当上下文的构建非常消耗资源时，带条件检查的日志记录或许是更好的方法。</li>
<li><code>Psr\Log\LoggerAwareInterface</code> 接口仅包括一个 <code>setLogger(LoggerInterface $logger)</code> 方法，框架可以使用它实现自动连接任何的日志记录实例。</li>
<li><code>Psr\Log\LoggerAwareTrait</code> trait 可复用代码块可以在任何的类里面使用，只需要通过它提供的 <code>$this-&gt;logger</code>，就可以轻松地实现等同的接口。</li>
<li><code>Psr\Log\LogLevel</code> 类装载了八个记录等级常量。</li>
</ul>
<h3 id="包"><a href="#包" class="headerlink" title="包"></a>包</h3><p>上述的接口、类和相关的异常类，以及一系列的实现检测文件，都包含在 <a href="https://packagist.org/packages/psr/log" target="_blank" rel="external">psr/log</a> 文件包中。</p>
<h3 id="Psr-Log-LoggerInterface"><a href="#Psr-Log-LoggerInterface" class="headerlink" title="Psr\Log\LoggerInterface"></a><code>Psr\Log\LoggerInterface</code></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">namespace</span> <span class="title">Psr</span>\<span class="title">Log</span>;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * 日志记录实例</span></div><div class="line"><span class="comment"> * </span></div><div class="line"><span class="comment"> * 日志信息变量 —— message, **必须** 是一个字符串或是实现了 __toString() 方法的对象。</span></div><div class="line"><span class="comment"> * </span></div><div class="line"><span class="comment"> * 日志信息变量中 **可以** 包含格式如 “&#123;foo&#125;”（代表 foo）的占位符</span></div><div class="line"><span class="comment"> * 它将会由上下文数组中键名为‘foo’的键值替代。</span></div><div class="line"><span class="comment"> * </span></div><div class="line"><span class="comment"> * 上下文数组可以携带任意数量的数据，唯一的限制是，当它携带的是一个 exception 对象时，它的键名 **必须** 是 “exception”；</span></div><div class="line"><span class="comment"> * </span></div><div class="line"><span class="comment"> * 详情可参阅： https://github.com/PizzaLiu/PHP-FIG/blob/master/PSR-3-logger-interface-cn.md</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">LoggerInterface</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * 系统不可用</span></div><div class="line"><span class="comment">     *</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> string $message</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> array $context</span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span> null</span></div><div class="line"><span class="comment">     */</span></div><div class="line">     <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">emergency</span><span class="params">($message, array $context = array<span class="params">()</span>)</span></span>;</div><div class="line"></div><div class="line">     <span class="comment">/**</span></div><div class="line"><span class="comment">      * **必须** 立刻采取行动</span></div><div class="line"><span class="comment">      * </span></div><div class="line"><span class="comment">      * 例如： 在整个网站都垮掉了、数据库不可用了或者其他的情况下，**应该** 发送一条警报短信把你叫醒。</span></div><div class="line"><span class="comment">      * <span class="doctag">@param</span> string $message</span></div><div class="line"><span class="comment">      * <span class="doctag">@param</span> array $context</span></div><div class="line"><span class="comment">      * <span class="doctag">@return</span> null</span></div><div class="line"><span class="comment">      */</span></div><div class="line">      <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">alert</span><span class="params">($message, array $context = array<span class="params">()</span>)</span></span>;</div><div class="line"></div><div class="line">      <span class="comment">/**</span></div><div class="line"><span class="comment">       * 紧急情况</span></div><div class="line"><span class="comment">       * </span></div><div class="line"><span class="comment">       * 例如：程序组件不可用或者出现非预期的异常。</span></div><div class="line"><span class="comment">       *</span></div><div class="line"><span class="comment">       * <span class="doctag">@param</span> string $message</span></div><div class="line"><span class="comment">       * <span class="doctag">@param</span> array $context</span></div><div class="line"><span class="comment">       * <span class="doctag">@return</span> null</span></div><div class="line"><span class="comment">       */</span></div><div class="line">       <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">critical</span><span class="params">($message, array $context = array<span class="params">()</span>)</span></span>;</div><div class="line"></div><div class="line">       <span class="comment">/**</span></div><div class="line"><span class="comment">        * 运行时出现的错误，不需要立刻采取行动，但必须记录下来以备检测。</span></div><div class="line"><span class="comment">        *</span></div><div class="line"><span class="comment">        * <span class="doctag">@param</span> string $message</span></div><div class="line"><span class="comment">        * <span class="doctag">@param</span> string $context</span></div><div class="line"><span class="comment">        * <span class="doctag">@return</span> null</span></div><div class="line"><span class="comment">        */</span></div><div class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">error</span><span class="params">($message, array $context = array<span class="params">()</span>)</span></span>;</div><div class="line"></div><div class="line">        <span class="comment">/**</span></div><div class="line"><span class="comment">         * 出现非错误性的异常。</span></div><div class="line"><span class="comment">         * </span></div><div class="line"><span class="comment">         * <span class="doctag">@param</span> string $message</span></div><div class="line"><span class="comment">         * <span class="doctag">@param</span> array $context</span></div><div class="line"><span class="comment">         * <span class="doctag">@return</span> null</span></div><div class="line"><span class="comment">         */</span></div><div class="line">         <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">warning</span><span class="params">($message, array $context = array<span class="params">()</span>)</span></span>;</div><div class="line"></div><div class="line">         <span class="comment">/**</span></div><div class="line"><span class="comment">          * 一般性重要的事件。</span></div><div class="line"><span class="comment">          *</span></div><div class="line"><span class="comment">          * <span class="doctag">@param</span> string $message</span></div><div class="line"><span class="comment">          * <span class="doctag">@param</span> array $context</span></div><div class="line"><span class="comment">          * <span class="doctag">@return</span> null</span></div><div class="line"><span class="comment">          */</span></div><div class="line">          <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">notice</span><span class="params">($message, array $context = array<span class="params">()</span>)</span></span>;</div><div class="line"></div><div class="line">          <span class="comment">/**</span></div><div class="line"><span class="comment">           * 重要事件</span></div><div class="line"><span class="comment">           *</span></div><div class="line"><span class="comment">           * 例如：用户登录和 SQL 记录</span></div><div class="line"><span class="comment">           *</span></div><div class="line"><span class="comment">           * <span class="doctag">@param</span> string $message</span></div><div class="line"><span class="comment">           * <span class="doctag">@param</span> array $context</span></div><div class="line"><span class="comment">           * <span class="doctag">@return</span> null</span></div><div class="line"><span class="comment">           */</span></div><div class="line">           <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">info</span><span class="params">($message, array $context = array<span class="params">()</span>)</span></span>;</div><div class="line"></div><div class="line">           <span class="comment">/**</span></div><div class="line"><span class="comment">            * debug 详情</span></div><div class="line"><span class="comment">            * </span></div><div class="line"><span class="comment">            * <span class="doctag">@param</span> string $message</span></div><div class="line"><span class="comment">            * <span class="doctag">@param</span> array $context</span></div><div class="line"><span class="comment">            * <span class="doctag">@return</span> null</span></div><div class="line"><span class="comment">            */</span></div><div class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">debug</span><span class="params">($message, array $context = array<span class="params">()</span>)</span></span>;</div><div class="line"></div><div class="line">            <span class="comment">/**</span></div><div class="line"><span class="comment">             * 任意等级的日志记录</span></div><div class="line"><span class="comment">             * </span></div><div class="line"><span class="comment">             * <span class="doctag">@param</span> mixed $level</span></div><div class="line"><span class="comment">             * <span class="doctag">@param</span> string $message</span></div><div class="line"><span class="comment">             * <span class="doctag">@return</span> null</span></div><div class="line"><span class="comment">             */</span></div><div class="line">             <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">log</span><span class="params">($level, $message, array $context = array<span class="params">()</span>)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Psr-Log-LoggerAwareInterface"><a href="#Psr-Log-LoggerAwareInterface" class="headerlink" title="Psr\Log\LoggerAwareInterface"></a><code>Psr\Log\LoggerAwareInterface</code></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">namespace</span> <span class="title">Psr</span>\<span class="title">Log</span>;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * logger-aware 定义实例</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">LoggerAwareInterface</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * 设置一个日志记录实例</span></div><div class="line"><span class="comment">     *</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> LoggerInterface $logger</span></div><div class="line"><span class="comment">     * <span class="doctag">@return</span> null</span></div><div class="line"><span class="comment">     */</span></div><div class="line">     <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setLogger</span><span class="params">(LoggerInterface $logger)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Psr-Log-LogLevel"><a href="#Psr-Log-LogLevel" class="headerlink" title="Psr\Log\LogLevel"></a><code>Psr\Log\LogLevel</code></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">namespace</span> <span class="title">Psr</span>\<span class="title">Log</span>;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * 日志等级常量定义</span></div><div class="line"><span class="comment"> */</span></div><div class="line"> <span class="class"><span class="keyword">class</span> <span class="title">LogLevel</span></span></div><div class="line"><span class="class"> </span>&#123;</div><div class="line">    <span class="keyword">const</span> EMERGENCY = <span class="string">'emergency'</span>;</div><div class="line">    <span class="keyword">const</span> ALERT     = <span class="string">'alert'</span>;</div><div class="line">    <span class="keyword">const</span> CRITICAL  = <span class="string">'critical'</span>;</div><div class="line">    <span class="keyword">const</span> ERROR     = <span class="string">'error'</span>;</div><div class="line">    <span class="keyword">const</span> WARNING   = <span class="string">'warning'</span>;</div><div class="line">    <span class="keyword">const</span> NOTICE    = <span class="string">'notice'</span>;</div><div class="line">    <span class="keyword">const</span> INFO      = <span class="string">'info'</span>;</div><div class="line">    <span class="keyword">const</span> DEBUG     = <span class="string">'debug'</span>;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<p>来自：<a href="https//psr.phphub.org">https://psr.phphub.org</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/07/the-PSR-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dearmadman">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Team.dearmadman.com">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/05/07/the-PSR-2/" itemprop="url">PSR 规范 —— PSR-2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-07T17:21:04+08:00">
                2016-05-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="PHP-Standard-Recommendations"><a href="#PHP-Standard-Recommendations" class="headerlink" title="PHP Standard Recommendations"></a>PHP Standard Recommendations</h1><blockquote>
<p>PSR 是 PHP Standard Recommendations 的简写，它是由 <a href="https://github.com/php-fig" target="_blank" rel="external">PHP FIG</a> 组织制定的 PHP 规范，是 PHP 开发的实践标准。</p>
</blockquote>
<h2 id="序号2：编码风格规范"><a href="#序号2：编码风格规范" class="headerlink" title="序号2：编码风格规范"></a>序号2：编码风格规范</h2><p>本篇规范是在 <a href="../the-PSR-1">PSR-1</a> 基础代码规范的继承与扩展 。<br>本规范希望通过制定一系列规范化 PHP 代码的规则，以减少在浏览不同作者的代码时，因为代码风格的不同而造成不便。<br>当多名程序员在多个项目中合作时，就需要一个共同的编码规范，而本文中的风格规范源自于多个不同项目代码风格的共同特性，因此，本规范的价值在于我们都遵循这个编码风格，而不是在于它本身。</p>
<h2 id="关于“能愿动词”的使用"><a href="#关于“能愿动词”的使用" class="headerlink" title="关于“能愿动词”的使用"></a>关于“能愿动词”的使用</h2><p>为了避免歧义，文档大量使用了“能愿动词”，对应的解释如下：</p>
<ul>
<li><code>必须（MUST）</code>：绝对，严格遵循，请照做，无条件遵守；</li>
<li><code>一定不可（MUST NOT）</code>：禁令，严令禁止；</li>
<li><code>应该（SHOULD）</code>：强烈建议这样做，但是不强求；</li>
<li><code>不该（SHOULD NOT）</code>：强烈不建议这样做，但是不强求；</li>
<li><code>可以（MAY）</code> 和 <code>可选（OPTIONAL）</code>：选择性高一点，在这个文档内，此词语使用较少；</li>
</ul>
<blockquote>
<p>参见：<a href="http://www.ietf.org/rfc/rfc2119.txt" target="_blank" rel="external">RFC 2119</a></p>
</blockquote>
<h2 id="概览"><a href="#概览" class="headerlink" title="概览"></a>概览</h2><ul>
<li>代码 <strong>必须</strong> 遵循 <a href="../the-PSR-1">PSR-1</a> 中的编码规范。</li>
<li>代码 <strong>必须</strong> 使用4个空格符而不是“Tab 键”进行缩进。</li>
<li>每行的字符数 <strong>应该</strong> 软性保持在 80 个之内，理论上 <strong>一定不可</strong> 多于 120 个，但 <strong>一定不可</strong> 有硬性限制。</li>
<li>每个 <code>namespace</code> 命名空间声明语句和 <code>use</code> 声明语句块后面，<strong>必须</strong> 插入一个空白行。</li>
<li>类的开始花括号 <code>{</code> <strong>必须</strong> 写在声明后自成一行，结束花括号 <code>}</code> 也 <strong>必须</strong> 写在函数主体后自成一行。</li>
<li>方法的开始花括号 <code>{</code> <strong>必须</strong> 写在函数声明后自成一行，结束花括号 <code>}</code> 也 <strong>必须</strong> 写在函数主体后自成一行。</li>
<li>类的属性和方法 <strong>必须</strong> 添加访问修饰符（<code>private</code>、<code>protected</code> 以及 <code>public</code>），<code>abstract</code> 以及 <code>final</code> <strong>必须</strong> 声明在访问修饰符之前，而 <code>static</code> <strong>必须</strong> 声明在访问修饰符之后。</li>
<li>控制结构的关键字后 <strong>必须</strong> 要有一个空格符，而调用方法或函数时则 <strong>一定不可</strong> 有。</li>
<li>控制结构的开始花括号 <code>{</code> <strong>必须</strong> 写在声明的同一行，而结束花括号 <code>}</code> <strong>必须</strong> 写在主体后自成一行。</li>
<li>控制结构的开始左括号后和结束右括号前，都 <strong>一定不可</strong> 有空格符。</li>
</ul>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><p>以下例子程序简单地展示了以上大部分规范：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">namespace</span> <span class="title">Vendor</span>\<span class="title">Package</span>;</div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">FooInterface</span>;</div><div class="line"><span class="keyword">use</span> <span class="title">BarClass</span> <span class="title">as</span> <span class="title">Bar</span>;</div><div class="line"><span class="keyword">use</span> <span class="title">OtherVendor</span>\<span class="title">OtherPackage</span>\<span class="title">BazClass</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> <span class="keyword">extends</span> <span class="title">Bar</span> <span class="keyword">implements</span> <span class="title">FooInterface</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">sampleFunction</span><span class="params">($a, $b = null)</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="keyword">if</span> ($a === $b) &#123;</div><div class="line">           bar();</div><div class="line">        &#125; <span class="keyword">elseif</span> ($a &gt; $b) &#123;</div><div class="line">           $foo-&gt;bar($arg1);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">           BazClass::bar($arg2, $arg3);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">final</span> <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">bar</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="comment">// ...</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="通则"><a href="#通则" class="headerlink" title="通则"></a>通则</h3><h4 id="基本编码准则"><a href="#基本编码准则" class="headerlink" title="基本编码准则"></a>基本编码准则</h4><p>代码 <strong>必须</strong> 符合 <a href="../the-PSR-1">PSR-1</a> 中的所有规范。</p>
<h4 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h4><p>所有 PHP 文件 <strong>必须</strong> 使用 <code>Unix LF (linefeed)</code> 作为行的结束符。<br>所有 PHP 文件 <strong>必须</strong> 以一个空白行作为结束。<br>纯 PHP 代码文件 <strong>必须</strong> 省略最后的 <code>?&gt;</code>结束标签。</p>
<h4 id="行"><a href="#行" class="headerlink" title="行"></a>行</h4><p>行的长度 <strong>一定不可</strong> 有硬性的约束。<br>软性的长度约束 <strong>必须</strong> 要限制在 120 个字符以内，若超过此长度，带代码规范检查的编辑器 <strong>必须</strong> 要发出警告，不过 <strong>一定不可</strong> 发出错误提示。<br>每行 <strong>不该</strong> 多于 80 个字符，大于 80 个字符的行 <strong>应该</strong> 折成多行。<br>非空行后 <strong>一定不可</strong> 有多余的空格符。<br>空行 <strong>可以</strong> 使得阅读代码更加方便以及有助于代码的分块。<br>每行 <strong>一定不可</strong> 存在多于一条语句。</p>
<h4 id="缩进"><a href="#缩进" class="headerlink" title="缩进"></a>缩进</h4><p>代码 <strong>必须</strong> 使用 4 个空格符的缩进， <strong>一定不可</strong> 用 tab 缩进。</p>
<blockquote>
<p>备注：使用空格而不是 tab 缩进的好处在于，避免在比较代码差异、打补丁、重阅代码以及注释时产生混淆。并且，使用空格缩进，让对齐变得更方便。</p>
</blockquote>
<h4 id="关键字以及-True-False-Null"><a href="#关键字以及-True-False-Null" class="headerlink" title="关键字以及 True/False/Null"></a>关键字以及 True/False/Null</h4><p>PHP 所有关键字 <strong>必须</strong> 全部小写。<br>常量 <code>true</code>、<code>false</code> 和 <code>null</code> 也 <strong>必须</strong> 全部小写。</p>
<h3 id="namespace-以及-use-声明"><a href="#namespace-以及-use-声明" class="headerlink" title="namespace 以及 use 声明"></a>namespace 以及 use 声明</h3><p><code>namespace</code> 声明后 <strong>必须</strong> 插入一个空白行。<br>所有 <code>use</code> <strong>必须</strong> 在 <code>namespace</code> 后声明。<br>每条 <code>use</code> 声明语句 <strong>必须</strong> 只有一个 <code>use</code> 关键字。<br><code>use</code> 声明语句块后 <strong>必须</strong> 要有一个空白行。<br>例如：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">namespace</span> <span class="title">Vendor</span>\<span class="title">Package</span>;</div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">FooClass</span>;</div><div class="line"><span class="keyword">use</span> <span class="title">BarClass</span> <span class="title">as</span> <span class="title">Bar</span>;</div><div class="line"><span class="keyword">use</span> <span class="title">OtherVendor</span>\<span class="title">OtherPackage</span>\<span class="title">BazClass</span>;</div><div class="line"></div><div class="line"><span class="comment">// ...</span></div></pre></td></tr></table></figure>
<h3 id="类、属性和方法"><a href="#类、属性和方法" class="headerlink" title="类、属性和方法"></a>类、属性和方法</h3><p>此处的‘类’泛指所有的‘class类’、‘接口’以及‘traits’可复用代码块。</p>
<h4 id="扩展与继承"><a href="#扩展与继承" class="headerlink" title="扩展与继承"></a>扩展与继承</h4><p>关键字 <code>extends</code> 和 <code>implements</code> <strong>必须</strong> 写在类名称的同一行。<br>类的开始花括号 <strong>必须</strong> 独占一行，结束花括号也 <strong>必须</strong> 在类主体后独占一行。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">namespace</span> <span class="title">Vendor</span>\<span class="title">Package</span>;</div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">FooClass</span>;</div><div class="line"><span class="keyword">use</span> <span class="title">BarClass</span> <span class="title">as</span> <span class="title">Bar</span>;</div><div class="line"><span class="keyword">use</span> <span class="title">OtherVendor</span>\<span class="title">OtherPackage</span>\<span class="title">BazClass</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassName</span> <span class="keyword">extends</span> <span class="title">ParentClass</span> <span class="keyword">implements</span> \<span class="title">ArrayAccess</span>, \<span class="title">Countable</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>implements</code> 的继承列表也 <strong>可以</strong> 分成多行，这样的话，每个继承接口名称都 <strong>必须</strong> 分开独立成行，包括第一个。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">namespace</span> <span class="title">Vendor</span>\<span class="title">Package</span>;</div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">FooClass</span>;</div><div class="line"><span class="keyword">use</span> <span class="title">BarClass</span> <span class="title">as</span> <span class="title">Bar</span>;</div><div class="line"><span class="keyword">use</span> <span class="title">OtherVendor</span>\<span class="title">OtherPackage</span>\<span class="title">BazClass</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassName</span> <span class="keyword">extends</span> <span class="title">ParentClass</span> <span class="keyword">implements</span></span></div><div class="line"><span class="class">    \<span class="title">ArrayAccess</span>,</span></div><div class="line"><span class="class">    \<span class="title">Countable</span>,</span></div><div class="line"><span class="class">    \<span class="title">Serializable</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="comment">//...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h4><p>每个属性都 <strong>必须</strong> 添加访问修饰符。<br><strong>一定不可</strong> 使用关键字 <code>var</code> 声明一个属性。<br>每条语句 <strong>一定不可</strong> 定义超过一个属性。<br><strong>不该</strong> 使用下划线作为前缀，来区分属性是 protected 或 private。<br>以下是属性声明的一个范例：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">namespace</span> <span class="title">Vendor</span>\<span class="title">Package</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassName</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> $foo = <span class="keyword">null</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><p>所有方法都 <strong>必须</strong> 添加访问修饰符。<br><strong>不该</strong> 使用下划线作为前缀，来区分方法是 protected 或 private。<br>方法名称后 <strong>一定不可</strong> 有空格符，其开始花括号 <strong>必须</strong> 独占一行，结束花括号也 <strong>必须</strong> 在方法主体后单独成一行。参数左括号后和右括号前 <strong>一定不可</strong> 有空格。<br>一个标准的方法声明可参照以下范例，留意其括号、逗号、空格以及花括号的位置：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">namespace</span> <span class="title">Vendor</span>\<span class="title">Package</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassName</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">fooBarBaz</span><span class="params">($arg1, &amp;$arg2, $arg = [])</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="comment">// ...</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="方法的参数"><a href="#方法的参数" class="headerlink" title="方法的参数"></a>方法的参数</h4><p>参数列表中，每个逗号后面 <strong>必须</strong> 要有一个空格，而逗号前面 <strong>一定不可</strong> 有空格。<br>有默认值的参数，<strong>必须</strong> 放到参数列表的末尾。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">namespace</span> <span class="title">Vendor</span>\<span class="title">Package</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassName</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">($arg1, &amp;$arg2, $arg3 = [])</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="comment">// ...</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>参数列表 <strong>可以</strong> 分列成多行，这样，包括第一个参数在内的每个参数都 <strong>必须</strong> 单独成行。<br>拆分成多行的参数列表后，结束括号以及方法开始花括号 <strong>必须</strong> 写在同一行，中间用一个空格分隔。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">namespace</span> <span class="title">Vendor</span>\<span class="title">Package</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassName</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">aVeryLongMethodName</span><span class="params">(</span></span></div><div class="line"><span class="function"><span class="params">        ClassTypeHint $arg1,</span></span></div><div class="line"><span class="function"><span class="params">        &amp;$arg2,</span></span></div><div class="line"><span class="function"><span class="params">        array $arg3 = []</span></span></div><div class="line"><span class="function"><span class="params">    )</span> </span>&#123;</div><div class="line">        <span class="comment">// ...</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="abstract、final-以及-static"><a href="#abstract、final-以及-static" class="headerlink" title="abstract、final 以及 static"></a><code>abstract</code>、<code>final</code> 以及 <code>static</code></h4><p>需要添加 <code>abstract</code> 或 <code>final</code> 声明时，<strong>必须</strong> 写在访问修饰符前，而 <code>static</code> 则 <strong>必须</strong> 写在其后。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">namespace</span> <span class="title">Vendor</span>\<span class="title">Package</span>;</div><div class="line"></div><div class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassName</span></span></div><div class="line"><span class="class"></span>&#123;</div><div class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> $foo;</div><div class="line">    <span class="keyword">abstract</span> <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">zim</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="keyword">final</span> <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">bar</span><span class="params">()</span></span></div><div class="line"><span class="function">    </span>&#123;</div><div class="line">        <span class="comment">// ...</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="方法及函数调用"><a href="#方法及函数调用" class="headerlink" title="方法及函数调用"></a>方法及函数调用</h4><p>方法及函数调用时，方法名或函数名与参数左括号之间 <strong>一定不可</strong> 有空格，参数右括号前也 <strong>一定不可</strong> 有空格。每个参数前 <strong>一定不可</strong> 有空格，但其后 <strong>必须</strong> 有一个空格。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">bar();</div><div class="line">$foo-&gt;bar($arg1);</div><div class="line">Foo::bar($arg2, $arg3);</div></pre></td></tr></table></figure>
<p>参数 <strong>可以</strong> 分列成多行，此时包括第一个参数在内的每个参数都 <strong>必须</strong> 单独成行。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$foo-&gt;bar(</div><div class="line">    $longArgument,</div><div class="line">    $longerArgument,</div><div class="line">    $muchLongerArgument</div><div class="line">);</div></pre></td></tr></table></figure>
<h3 id="控制结构"><a href="#控制结构" class="headerlink" title="控制结构"></a>控制结构</h3><p>控制结构的基本规范如下：</p>
<ul>
<li>控制结构关键字后 <strong>必须</strong> 有一个空格</li>
<li>左括号 <code>(</code> 后 <strong>一定不可</strong> 有空格</li>
<li>右括号 <code>)</code> 前也 <strong>一定不可</strong> 有空格</li>
<li>右括号 <code>)</code> 与开始花括号 <code>{</code> 间 <strong>必须</strong> 有一个空格。</li>
<li>结构体主体 <strong>必须</strong> 要有一次缩进。</li>
<li>结束花括号 <code>}</code> <strong>必须</strong> 在结构体主体后单独成行。</li>
</ul>
<p>每个结构体的主体都 <strong>必须</strong> 被包含在成对的花括号之中，这能让结构体更加结构化，以及减少加入新行时，出错的可能性。</p>
<h4 id="if、elseif-和-else"><a href="#if、elseif-和-else" class="headerlink" title="if、elseif 和 else"></a><code>if</code>、<code>elseif</code> 和 <code>else</code></h4><p>标准的 <code>if</code> 结构如下代码所示，请留意‘括号’、‘空格’以及‘花括号’的位置，注意 <code>else</code> 和 <code>elseif</code> 都与前面的结束花括号在同一行。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">if</span> ($expr1) &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125; <span class="keyword">elseif</span> ($expr2) &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>应该</strong> 使用关键字 <code>elseif</code> 代替所有 <code>else if</code>，以使得所有的控制关键字都像是单独的一个词。</p>
<h4 id="switch-和-case"><a href="#switch-和-case" class="headerlink" title="switch 和 case"></a><code>switch</code> 和 <code>case</code></h4><p>标准的 <code>switch</code> 结构如下代码所示，留意括号、空格以及花括号的位置。<code>case</code> 语句 <strong>必须</strong> 相对 <code>switch</code> 进行一次缩进，而 <code>break</code> 语句以及 <code>case</code> 内的其它语句都 <strong>必须</strong> 相对 <code>case</code> 进行一次缩进。<br>如果存在非空的 <code>case</code> 直穿语句，主体里 <strong>必须</strong> 有类似 <code>// no break</code> 的注释。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">switch</span> ($expr) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="number">0</span>:</div><div class="line">        <span class="keyword">echo</span> <span class="string">'First case, with a break'</span>;</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">        <span class="keyword">echo</span> <span class="string">'Second case, which falls through'</span>;</div><div class="line">        <span class="comment">// no break;</span></div><div class="line">    <span class="keyword">case</span> <span class="number">2</span>:</div><div class="line">    <span class="keyword">case</span> <span class="number">3</span>:</div><div class="line">    <span class="keyword">case</span> <span class="number">4</span>:</div><div class="line">        <span class="keyword">echo</span> <span class="string">'Third case, return instead of break'</span>;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">default</span>:</div><div class="line">        <span class="keyword">echo</span> <span class="string">'Default case'</span>;</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="while-和-do-while"><a href="#while-和-do-while" class="headerlink" title="while 和 do while"></a><code>while</code> 和 <code>do while</code></h4><p>一个规范的 <code>while</code> 语句应该如下所示，注意‘括号’、‘空格’以及‘花括号’的位置。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">while</span> ($expr) &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>标准的 <code>do while</code> 语句如下所示，同样的，注意其‘括号’、‘空格’以及‘花括号’的位置。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">do</span> &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125; <span class="keyword">while</span> ($expr);</div></pre></td></tr></table></figure>
<h4 id="for"><a href="#for" class="headerlink" title="for"></a><code>for</code></h4><p>标准的 <code>for</code> 语句如下所示，注意其‘括号’、‘空格’以及‘花括号’的位置。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; <span class="number">10</span>; $i++) &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="foreach"><a href="#foreach" class="headerlink" title="foreach"></a><code>foreach</code></h4><p>标准的 <code>foreach</code> 语句如下所示，注意其‘括号’、‘空格’以及‘花括号’的位置。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">foreach</span> ($iterable <span class="keyword">as</span> $key =&gt; $value) &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="try-和-catch"><a href="#try-和-catch" class="headerlink" title="try 和 catch"></a><code>try</code> 和 <code>catch</code></h4><p>标准的 <code>try catch</code> 语句如下所示，注意其‘括号’、‘空格’以及‘花括号’的位置。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125; <span class="keyword">catch</span> (FirstExceptionType $e) &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125; <span class="keyword">catch</span> (OtherExceptionType $e) &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h3><p>闭包声明时，关键字 <code>function</code> 后以及关键字 <code>use</code> 的前后都 <strong>必须</strong> 要有一个空格。<br>开始花括号 <strong>必须</strong> 写在声明的同一行，结束花括号 <strong>必须</strong> 紧跟主体结束的下一行。<br>参数列表和变量列表的左括号后以及右括号前，<strong>一定不可</strong> 有空格。<br>参数和变量列表中，逗号前 <strong>一定不可</strong> 有空格，而逗号后 <strong>必须</strong> 要有空格。<br>闭包中有默认值的参数 <strong>必须</strong> 放到列表的后面。<br>标准的闭包声明语句如下所示，请注意其‘括号’、‘空格’以及‘花括号’的位置。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$closureWithArgs = <span class="function"><span class="keyword">function</span> <span class="params">($arg1, $arg2)</span> </span>&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line">$closureWithArgsAndVars = <span class="function"><span class="keyword">function</span> <span class="params">($arg1, $arg2)</span> <span class="title">use</span> <span class="params">($var1, $var2)</span> </span>&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>参数列表以及变量列表 <strong>可以</strong> 分成多行，这样，包括第一个在内的每个参数或变量都 <strong>必须</strong> 单独成行，而列表的右括号与闭包的开始花括号 <strong>必须</strong> 放在同一行。<br>以下几个例子，包含了参数和变量列表被分成多行的多情况。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$longArgs_noVars = <span class="function"><span class="keyword">function</span> <span class="params">(</span></span></div><div class="line"><span class="function"><span class="params">    $longArgument,</span></span></div><div class="line"><span class="function"><span class="params">    $longerArgument,</span></span></div><div class="line"><span class="function"><span class="params">    $muchLongerArgument</span></span></div><div class="line"><span class="function"><span class="params">)</span> </span>&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line">$noArgs_longVars = <span class="function"><span class="keyword">function</span> <span class="params">()</span> <span class="title">use</span> <span class="params">(</span></span></div><div class="line"><span class="function"><span class="params">    $longVar1,</span></span></div><div class="line"><span class="function"><span class="params">    $longVar2,</span></span></div><div class="line"><span class="function"><span class="params">    $muchLongerVar3</span></span></div><div class="line"><span class="function"><span class="params">)</span> </span>&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line">$longArgs_longVars = <span class="function"><span class="keyword">function</span> <span class="params">(</span></span></div><div class="line"><span class="function"><span class="params">    $longArgument,</span></span></div><div class="line"><span class="function"><span class="params">    $longerArgument,</span></span></div><div class="line"><span class="function"><span class="params">    $muchLongerArgument</span></span></div><div class="line"><span class="function"><span class="params">)</span> <span class="title">use</span> <span class="params">(</span></span></div><div class="line"><span class="function"><span class="params">    $longVar1,</span></span></div><div class="line"><span class="function"><span class="params">    $longerVar2,</span></span></div><div class="line"><span class="function"><span class="params">    $muchLongerVar3</span></span></div><div class="line"><span class="function"><span class="params">)</span> </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line">$longArgs_shortVars = <span class="function"><span class="keyword">function</span> <span class="params">(</span></span></div><div class="line"><span class="function"><span class="params">    $longArgument,</span></span></div><div class="line"><span class="function"><span class="params">    $longerArgument,</span></span></div><div class="line"><span class="function"><span class="params">    $muchLongerArgument</span></span></div><div class="line"><span class="function"><span class="params">)</span> <span class="title">use</span> <span class="params">($var1)</span> </span>&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">$shortArgs_longVars = <span class="function"><span class="keyword">function</span> <span class="params">($arg)</span> <span class="title">use</span> <span class="params">(</span></span></div><div class="line"><span class="function"><span class="params">    $longVar1,</span></span></div><div class="line"><span class="function"><span class="params">    $longerVar2,</span></span></div><div class="line"><span class="function"><span class="params">    $muchLongerVar3</span></span></div><div class="line"><span class="function"><span class="params">)</span> </span>&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>注意，闭包被直接用作函数或方法调用的参数时，以上规则仍然适用。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$foo-&gt;bar(</div><div class="line">    $arg1,</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="params">($arg2)</span> <span class="title">use</span> <span class="params">($var1)</span> </span>&#123;</div><div class="line">        <span class="comment">// ...</span></div><div class="line">    &#125;,</div><div class="line">    $arg3</div><div class="line">);</div></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>以上规范难免有疏忽，其中包括但不仅限于：</p>
<ul>
<li>全集变量和常量的定义</li>
<li>函数的定义</li>
<li>操作符和赋值</li>
<li>行内对齐</li>
<li>注释和文档描述块</li>
<li>类名的前缀及后缀</li>
<li>最佳实践</li>
</ul>
<p>本规范之后的修订与扩展将弥补以上不足。</p>
<p>来自：<a href="https//psr.phphub.org">https://psr.phphub.org</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/07/the-PSR-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dearmadman">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Team.dearmadman.com">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/05/07/the-PSR-1/" itemprop="url">PSR 规范 —— PSR-1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-07T16:21:42+08:00">
                2016-05-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="PHP-Standard-Recommendations"><a href="#PHP-Standard-Recommendations" class="headerlink" title="PHP Standard Recommendations"></a>PHP Standard Recommendations</h1><blockquote>
<p>PSR 是 PHP Standard Recommendations 的简写，它是由 <a href="https://github.com/php-fig" target="_blank" rel="external">PHP FIG</a> 组织制定的 PHP 规范，是 PHP 开发的实践标准。</p>
</blockquote>
<h2 id="序号-1：基本代码规范"><a href="#序号-1：基本代码规范" class="headerlink" title="序号 1：基本代码规范"></a>序号 1：基本代码规范</h2><p>本篇规范制定了代码基本元素的相关标准，以确保共享的 PHP 代码间具有较高程度的技术互通性。</p>
<h3 id="关于“能愿动词”的使用"><a href="#关于“能愿动词”的使用" class="headerlink" title="关于“能愿动词”的使用"></a>关于“能愿动词”的使用</h3><p>为了避免歧义，文档大量使用了“能愿动词”，对应的解释如下：</p>
<ul>
<li><code>必须（MUST）</code>：绝对，严格遵循，请照做，无条件遵守；</li>
<li><code>一定不可（MUST NOT）</code>：禁令，严令禁止；</li>
<li><code>应该（SHOULD）</code>：强烈建议这样做，但是不强求；</li>
<li><code>不该（SHOULD NOT）</code>：强烈不建议这样做，但是不强求；</li>
<li><code>可以（MAY）</code> 和 <code>可选（OPTIONAL）</code>：选择性高一点，在这个文档内，此词语使用较少；</li>
</ul>
<blockquote>
<p>参见：<a href="http://www.ietf.org/rfc/rfc2119.txt" target="_blank" rel="external">RFC 2119</a></p>
</blockquote>
<h3 id="概览"><a href="#概览" class="headerlink" title="概览"></a>概览</h3><ul>
<li>PHP 代码文件 <strong>必须</strong> 以 <code>&lt;?php</code> 或 <code>&lt;?=</code> 标签开始；</li>
<li>PHP 代码文件 <strong>必须</strong> 以 <code>不带 BOM 的 UTF-8</code> 编码;</li>
<li>PHP 代码中 <strong>应该</strong> 只定义类、函数、常量等声明，或其他会产生 <code>副作用</code> 的操作（如：生成文件输出以及修改 .ini 配置文件等），二者只能选其一；</li>
<li>命名空间以及类 <strong>必须</strong> 符合 PSR 的自动加载规范：<a href="../the-PSR-4">PSR-4</a> 中的一个；</li>
<li>类的命名 <strong>必须</strong> 遵循 <code>StudlyCaps</code> 大写开头的驼峰命名规范；</li>
<li>类中的常量所有字母都 <strong>必须</strong> 大写，单词间用下划线分隔；</li>
<li>方法名称 <strong>必须</strong> 符合 <code>camelCase</code> 式的小写开头驼峰命名规范。</li>
</ul>
<h3 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h3><h4 id="PHP-标签"><a href="#PHP-标签" class="headerlink" title="PHP 标签"></a>PHP 标签</h4><p>PHP 代码 <strong>必须</strong> 使用 <code>&lt;?php ?&gt;</code> 长标签或 <code>&lt;?= &gt;?</code> 短标签；<strong>一定不可</strong> 使用其它自定义标签。</p>
<h4 id="字符编码"><a href="#字符编码" class="headerlink" title="字符编码"></a>字符编码</h4><p>PHP 代码 <strong>必须</strong> 且只可使用 <code>不带 BOM 的 UTF-8</code> 编码。</p>
<h4 id="副作用"><a href="#副作用" class="headerlink" title="副作用"></a>副作用</h4><p>一份 PHP 文件中 <strong>应该</strong> 要不就只定义新的声明，如类、函数或常量等不产生 <code>副作用</code> 的操作，要不就只书写会产生 <code>副作用</code> 的逻辑操作，但 <strong>不该</strong> 同时具有两者。</p>
<p>‘副作用’（side effects）一词的意思是，仅仅通过包含文件，不直接声明类、函数和常量等，而执行的逻辑操作。‘副作用’包括却不仅限于：</p>
<ul>
<li>生成输出</li>
<li>直接的 <code>require</code> 或 <code>include</code></li>
<li>连接外部服务</li>
<li>修改 ini 配置</li>
<li>抛出错误或异常</li>
<li>修改全局或静态变量</li>
<li>读或写文件等</li>
</ul>
<p>以下是一个 <code>反例</code>，一份包含‘函数声明’以及产生‘副作用’的代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">// ‘副作用’：修改 ini 配置</span></div><div class="line">ini_set(<span class="string">'error_reporting'</span>, E_ALL);</div><div class="line"></div><div class="line"><span class="comment">// ‘副作用’：引入文件</span></div><div class="line"><span class="keyword">include</span> <span class="string">'file.php'</span>;</div><div class="line"></div><div class="line"><span class="comment">// ‘副作用’：生成输出</span></div><div class="line"><span class="keyword">echo</span> <span class="string">"&lt;html&gt;\n"</span>;</div><div class="line"></div><div class="line"><span class="comment">// 声明函数</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="comment">// 函数主体部分</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>下面是一个范例，一份只包含声明不产生‘副作用’的代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">// 声明函数</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 条件声明 **不** 属于‘副作用’</span></div><div class="line"><span class="keyword">if</span> (! function_exists(<span class="string">'bar'</span>)) &#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">bar</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="comment">// ... </span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="命名空间和类"><a href="#命名空间和类" class="headerlink" title="命名空间和类"></a>命名空间和类</h3><p>命名空间以及类的命名必须遵循 <a href="../the-PSR-4">PSR-4</a>。<br>根据规范，每个类都独立为一个文件，且命名空间至少 有一个层次：顶级的组织名称（vendor name）。<br>类的命名 <strong>必须</strong> 遵循 <code>StudlyCaps</code> 大写开头的驼峰命名规范。<br>PHP 5.3 及以后版本的代码 <strong>必须</strong> 使用正式的命名空间。<br>例如：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">// PHP 5.3 及以后版本的写法</span></div><div class="line"><span class="keyword">namespace</span> <span class="title">Vendor</span>\<span class="title">Model</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>5.2.x 及之前的版本 <strong>应该</strong> 使用伪命名空间的写法，约定俗成使用顶级的组织名称（vendor name）如 <code>Vendor_</code> 为类前缀。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">// 5.2.x 及之前版本的写法</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vendor_Model_Foo</span> </span>&#123;</div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="类的常量、属性和方法"><a href="#类的常量、属性和方法" class="headerlink" title="类的常量、属性和方法"></a>类的常量、属性和方法</h3><p>此处的‘类’指代所有的类、接口以及可复用代码块（traits）。</p>
<h4 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h4><p>类的常量中所有字母都 <strong>必须</strong> 大写，词间以下划线分隔。参照以下代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">namespace</span> <span class="title">Vendor</span>\<span class="title">Model</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</div><div class="line">  <span class="keyword">const</span> VERSION = <span class="string">'1.0'</span>;</div><div class="line">  <span class="keyword">const</span> DATE_APPROVED = <span class="string">'2012-06-01'</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h4><p>类的属性命名 <strong>可以</strong> 遵循：</p>
<ul>
<li>大小写开头的驼峰式 <code>（$StudlyCaps）</code></li>
<li>小写开头的驼峰式 <code>（$camelCase）</code></li>
<li>下划线分隔式 <code>（$under_score）</code></li>
</ul>
<p>本规范不做强制要求，但无论遵循哪种命名方式，都 <strong>应该</strong> 在一定的范围保持一致。这个范围可以是整个团队、整个包、整个类或整个方法。</p>
<h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><p>方法名称 <strong>必须</strong> 符合 <code>camelClase()</code> 式的小写开头驼峰命名规范。</p>
<p>来自：<a href="https//psr.phphub.org">https://psr.phphub.org</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/07/chinese-copywriting-guildelines/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dearmadman">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Team.dearmadman.com">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/05/07/chinese-copywriting-guildelines/" itemprop="url">中文文案排版指北</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-07T14:21:46+08:00">
                2016-05-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="中文文案排版指北"><a href="#中文文案排版指北" class="headerlink" title="中文文案排版指北"></a>中文文案排版指北</h1><h2 id="空格"><a href="#空格" class="headerlink" title="空格"></a>空格</h2><blockquote>
<p>有研究显示，打字的时候不喜欢在中文和英文之间加空格的人，感情路都走的很艰辛，有七成的比例会在 34 岁的时候跟自己不爱的人结婚，而其余三成的人最后只能把遗产留给自己的猫。毕竟爱情跟书写都需要适时地留白。  —— <a href="https://github.com/vinta/pangu.js" target="_blank" rel="external">vinta/paranoid-auto-spacing</a></p>
</blockquote>
<h3 id="中英文之间需要增加空格"><a href="#中英文之间需要增加空格" class="headerlink" title="中英文之间需要增加空格"></a>中英文之间需要增加空格</h3><p>正确：</p>
<blockquote>
<p>在 LearnCloud 上，数据存储是围绕着 <code>AVObject</code> 进行的。</p>
</blockquote>
<p>错误：</p>
<blockquote>
<p>在LeanCloud上，数据存储是围绕AVObject进行的。<br>在 LeanCloud上，数据存储是围绕AVObject 进行的。</p>
</blockquote>
<p>完整的正确用法：</p>
<blockquote>
<p>在 LeanCloud 上，数据存储是围绕 <code>AVObject</code> 进行的。每个 <code>AVObject</code> 都包含了与 JSON 兼容的 key-value 对应的数据。 数据是 schema-free 的，你不需要再每个 <code>AVObject</code> 上提前指定存在哪些键，只要直接设定对应的 key-value 即可。</p>
</blockquote>
<p>例外：“豆瓣FM”等产品名词，按照官方所定义的格式书写。</p>
<h3 id="中文与数字之间需要增加空格"><a href="#中文与数字之间需要增加空格" class="headerlink" title="中文与数字之间需要增加空格"></a>中文与数字之间需要增加空格</h3><p>正确：</p>
<blockquote>
<p>今天出去买菜花了 5000 元。</p>
</blockquote>
<p>错误：</p>
<blockquote>
<p>今天出去买菜花了 5000元。<br>今天出去买菜花了5000元。</p>
</blockquote>
<h3 id="数字与单位之间需要增加空格"><a href="#数字与单位之间需要增加空格" class="headerlink" title="数字与单位之间需要增加空格"></a>数字与单位之间需要增加空格</h3><p>正确：</p>
<blockquote>
<p>我家的光纤入户宽带有 10 Gbps，SSD 一共有 20 TB。</p>
</blockquote>
<p>错误：</p>
<blockquote>
<p>我家的光纤入户宽带有 10Gbps，SSD 一共有 10TB。</p>
</blockquote>
<p>例外： 度/百分比与数字之间不需要增加空格：<br>正确：</p>
<blockquote>
<p>今天是 233° 的高温。<br>新 MacBook Pro 有 15% 的 CPU 性能提升。</p>
</blockquote>
<p>错误：</p>
<blockquote>
<p>今天是 233 ° 的高温。<br>新 MacBook Pro 有 15 % 的 CPU 性能提升。</p>
</blockquote>
<h3 id="全角标点与其他字符之间不加空格"><a href="#全角标点与其他字符之间不加空格" class="headerlink" title="全角标点与其他字符之间不加空格"></a>全角标点与其他字符之间不加空格</h3><p>正确：</p>
<blockquote>
<p>刚刚买了一部 iPhone，好开心！</p>
</blockquote>
<p>错误：</p>
<blockquote>
<p>刚刚买了一部 iPhone ，好开心！</p>
</blockquote>
<h3 id="ms-text-autospace-to-the-rescue"><a href="#ms-text-autospace-to-the-rescue" class="headerlink" title="-ms-text-autospace to the rescue?"></a><code>-ms-text-autospace</code> to the rescue?</h3><p>Microsoft 有个 <code>-ms-text-autospace</code> 的 CSS 属性可以实现自动为中英文之间增加空白。不过目前并未普及，另外在其他应用场景，例如 OS X、IOS 的用户机界面目前并不存在这个特性，所以请继续保持随手加空格的习惯。</p>
<h2 id="标点符号"><a href="#标点符号" class="headerlink" title="标点符号"></a>标点符号</h2><h3 id="不重复使用标点符号"><a href="#不重复使用标点符号" class="headerlink" title="不重复使用标点符号"></a>不重复使用标点符号</h3><p>正确：</p>
<blockquote>
<p>德国队竟然战胜了巴西队！<br>她竟然对你说 “喵”？！</p>
</blockquote>
<p>错误：</p>
<blockquote>
<p>德国队竟然战胜了巴西队！！<br>德国队竟然战胜了巴西队！！！！！！！！<br>她竟然对你说「喵」？？！！<br>她竟然对你说「喵」？！？！？？！！</p>
</blockquote>
<h3 id="全角和半角"><a href="#全角和半角" class="headerlink" title="全角和半角"></a>全角和半角</h3><p>不明白什么是全角与半角符号？请查看维基百科词条 <a href="https://zh.wikipedia.org/wiki/%E5%85%A8%E5%BD%A2%E5%92%8C%E5%8D%8A%E5%BD%A2" target="_blank" rel="external">全角和半角</a></p>
<h3 id="使用全角中文标点"><a href="#使用全角中文标点" class="headerlink" title="使用全角中文标点"></a>使用全角中文标点</h3><p>正确：</p>
<blockquote>
<p>嗨！你知道嘛？今天前台的小妹跟我说“喵”了哎！<br>核磁共振成像（NMRI）是什么原理都不知道？JFGI！</p>
</blockquote>
<p>错误：</p>
<blockquote>
<p>嗨! 你知道嘛? 今天前台的小妹跟我说 “喵” 了哎!<br>嗨!你知道嘛?今天前台的小妹跟我说”喵”了哎!<br>核磁共振成像 (NMRI) 是什么原理都不知道? JFGI!<br>核磁共振成像(NMRI)是什么原理都不知道?JFGI!</p>
</blockquote>
<h3 id="数字使用半角字符"><a href="#数字使用半角字符" class="headerlink" title="数字使用半角字符"></a>数字使用半角字符</h3><p>正确：</p>
<blockquote>
<p>这件蛋糕只卖 1000 元</p>
</blockquote>
<p>错误：</p>
<blockquote>
<p>这件蛋糕只卖 １０００ 元。</p>
</blockquote>
<p>例外： 在设计稿、宣传海报中如出现极少量数字的情形时，为方便文字对齐，是可以使用全角数字的。</p>
<h3 id="遇到完整的英文整句、特殊名词，其内容使用半角标点"><a href="#遇到完整的英文整句、特殊名词，其内容使用半角标点" class="headerlink" title="遇到完整的英文整句、特殊名词，其内容使用半角标点"></a>遇到完整的英文整句、特殊名词，其内容使用半角标点</h3><p>正确：</p>
<blockquote>
<p>乔布斯那句话是怎么说的？ “Stay hungry, stay foolish.”<br>推荐你阅读《Hackers &amp; Painters: Big Ideas from the Computer Age》，非常的有趣。</p>
</blockquote>
<p>错误：</p>
<blockquote>
<p>乔布斯那句话是怎么说的？「Stay hungry，stay foolish。」<br>推荐你阅读《Hackers＆Painters：Big Ideas from the Computer Age》，非常的有趣。</p>
</blockquote>
<h2 id="名词"><a href="#名词" class="headerlink" title="名词"></a>名词</h2><h3 id="专有名词使用正确的大小写"><a href="#专有名词使用正确的大小写" class="headerlink" title="专有名词使用正确的大小写"></a>专有名词使用正确的大小写</h3><p>大小写相关用法原属于英文书写范畴，不属于本 wiki 讨论内容，在这里只对部分易错用法进行简述。</p>
<p>正确：</p>
<blockquote>
<p>使用 GitHub 登录<br>我们的客户有 GitHub、Foursquare、Microsoft Corporation、Google、Facebook，Inc.。</p>
</blockquote>
<p>错误：</p>
<blockquote>
<p>使用 github 登录<br>使用 GITHUB 登录<br>使用 Github 登录<br>使用 gitHub 登录<br>使用 gｲんĤЦ8 登录<br>我们的客户有 github、foursquare、microsoft corporation、google、facebook, inc.。<br>我们的客户有 GITHUB、FOURSQUARE、MICROSOFT CORPORATION、GOOGLE、FACEBOOK, INC.。<br>我们的客户有 Github、FourSquare、MicroSoft Corporation、Google、FaceBook, Inc.。<br>我们的客户有 gitHub、fourSquare、microSoft Corporation、google、faceBook, Inc.。<br>我们的客户有 gｲんĤЦ8、ｷouЯƧquﾑгє、๓เςг๏ร๏Ŧt ς๏гק๏гคtเ๏ภn、900913、ƒ4ᄃëв๏๏к, IПᄃ.。</p>
</blockquote>
<p>注意：当网页中需要配合整体视觉风格而出现全部大写/小写的情形，HTML 中请使用标准的大小写规范进行书写；并通过 <code>text-transform: uppercase;</code>/<code>text-transform: lowercase;</code> 对表现形式进行定义。</p>
<h3 id="不要使用不地道的缩写"><a href="#不要使用不地道的缩写" class="headerlink" title="不要使用不地道的缩写"></a>不要使用不地道的缩写</h3><p>正确：</p>
<blockquote>
<p>我们需要一位熟悉 JavaScript、HTML5，至少理解一种框架（如 Backbone.js、AngularJS、React等）的前端开发者。</p>
</blockquote>
<p>错误：</p>
<blockquote>
<p>我们需要一位熟悉 Js、h5，至少理解一种框架（如 backbone、angular、RJS 等）的 FED。</p>
</blockquote>
<h2 id="争议"><a href="#争议" class="headerlink" title="争议"></a>争议</h2><p>以下用法略带有个人色彩，即：无论是否遵循下述规则，从语法的角度来讲都是正确的。</p>
<h3 id="链接之间增加空格"><a href="#链接之间增加空格" class="headerlink" title="链接之间增加空格"></a>链接之间增加空格</h3><p>用法：</p>
<blockquote>
<p>请 <a href="#">提交一个 issue</a> 并分配给相关同事<br>访问我们网站的最新动态，请 <a href="#">点击这里</a> 进行订阅！</p>
</blockquote>
<p>对比用法：</p>
<blockquote>
<p>请<a href="#">提交一个 issue</a>并分配给相关同事<br>访问我们网站的最新动态，请<a href="#">点击这里</a>进行订阅！</p>
</blockquote>
<h3 id="简体中文使用直角引号"><a href="#简体中文使用直角引号" class="headerlink" title="简体中文使用直角引号"></a>简体中文使用直角引号</h3><p>用法:</p>
<blockquote>
<p>「老师，『有条不紊』的『紊』是什么意思？」</p>
</blockquote>
<p>对比用法：</p>
<blockquote>
<p>“老师，‘有条不紊’的‘紊’是什么意思？”</p>
</blockquote>
<h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><table>
<thead>
<tr>
<th>仓库</th>
<th>语言</th>
</tr>
</thead>
<tbody>
<tr>
<td> <a href="https://github.com/vinta/pangu.js" target="_blank" rel="external">vinta/paranoid-auto-spacing</a></td>
<td>JavaScript</td>
</tr>
<tr>
<td> <a href="https://github.com/huei90/pangu.node" target="_blank" rel="external">huei90/pangu.node</a></td>
<td>NodeJs</td>
</tr>
<tr>
<td> <a href="https://github.com/huacnlee/auto-correct" target="_blank" rel="external">huacnlee/auto-correct</a></td>
<td>Ruby</td>
</tr>
<tr>
<td> <a href="https://github.com/sparanoid/space-lover" target="_blank" rel="external">sparanoid/space-lover</a></td>
<td>PHP (WordPress)</td>
</tr>
<tr>
<td> <a href="https://github.com/NauxLiu/auto-correct" target="_blank" rel="external">nauxliu/auto-correct</a></td>
<td>PHP</td>
</tr>
<tr>
<td> <a href="https://github.com/hotoo/pangu.vim" target="_blank" rel="external">hotoo/pangu.vim</a></td>
<td>Vim</td>
</tr>
<tr>
<td> <a href="https://github.com/sparanoid/grunt-auto-spacing" target="_blank" rel="external">sparanoid/grunt-auto-spacing</a></td>
<td>Node.js (Grunt)</td>
</tr>
<tr>
<td> <a href="https://github.com/hjiang/scripts/blob/master/add-space-between-latin-and-cjk" target="_blank" rel="external">hjiang/scripts/add-space-between-latin-and-cjk</a></td>
<td>Python</td>
</tr>
</tbody>
</table>
<h2 id="谁在这样做？"><a href="#谁在这样做？" class="headerlink" title="谁在这样做？"></a>谁在这样做？</h2><table>
<thead>
<tr>
<th>网站</th>
<th>文案</th>
<th>UGC</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://www.apple.com/cn/" target="_blank" rel="external">Apple 中国</a></td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="http://www.apple.com/hk/" target="_blank" rel="external">Apple 香港</a></td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="http://www.apple.com/tw/" target="_blank" rel="external">Apple 台湾</a></td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="http://www.microsoft.com/zh-cn/" target="_blank" rel="external">Microsoft 中国</a></td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="http://www.microsoft.com/zh-hk/" target="_blank" rel="external">Microsoft 香港</a></td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="http://www.microsoft.com/zh-tw/" target="_blank" rel="external">Microsoft 台湾</a></td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="https://leancloud.cn/" target="_blank" rel="external">LeanCloud</a></td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="https://www.zhihu.com/" target="_blank" rel="external">知乎</a></td>
<td>Yes</td>
<td>部分用户达成</td>
</tr>
<tr>
<td><a href="https://www.v2ex.com/" target="_blank" rel="external">V2EX</a></td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td><a href="https://segmentfault.com/" target="_blank" rel="external">SegmentFault</a></td>
<td>Yes</td>
<td>部分用户达成</td>
</tr>
<tr>
<td><a href="http://apple4us.com/" target="_blank" rel="external">Apple4us</a></td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="https://www.wandoujia.com/" target="_blank" rel="external">豌豆荚</a></td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr>
<td><a href="https://ruby-china.org/" target="_blank" rel="external">Ruby China</a></td>
<td>Yes</td>
<td>标题达成</td>
</tr>
<tr>
<td><a href="https://phphub.org/" target="_blank" rel="external">PHPHub</a></td>
<td>Yes</td>
<td>标题达成</td>
</tr>
</tbody>
</table>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a href="http://grammar.about.com/od/punctuationandmechanics/a/Guidelines-For-Using-Capital-Letters.htm" target="_blank" rel="external">Guidelines for Using Capital Letters</a></li>
<li><a href="http://en.wikipedia.org/wiki/Letter_case" target="_blank" rel="external">Letter case - Wikipedia</a></li>
<li><a href="http://www.oxforddictionaries.com/words/punctuation" target="_blank" rel="external">Punctuation - Oxford Dictionaries</a></li>
<li><a href="https://owl.english.purdue.edu/owl/section/1/6/" target="_blank" rel="external">Punctuation - The Purdue OWL</a></li>
<li><a href="http://www.wikihow.com/Use-English-Punctuation-Correctly" target="_blank" rel="external">How to Use English Punctuation Corrently - wikiHow</a></li>
<li><a href="https://zh.opensuse.org/index.php?title=Help:%E6%A0%BC%E5%BC%8F" target="_blank" rel="external">格式 - openSUSE</a></li>
<li><a href="http://zh.wikipedia.org/wiki/%E5%85%A8%E5%BD%A2%E5%92%8C%E5%8D%8A%E5%BD%A2" target="_blank" rel="external">全角和半角 - 维基百科</a></li>
<li><a href="http://zh.wikipedia.org/wiki/%E5%BC%95%E8%99%9F" target="_blank" rel="external">引号 - 维基百科</a></li>
<li><a href="http://zh.wikipedia.org/wiki/%E7%96%91%E5%95%8F%E9%A9%9A%E5%98%86%E8%99%9F" target="_blank" rel="external">疑问惊叹号 - 维基百科</a></li>
</ul>
<p>原文地址: <a href="http://mazhuang.org/wiki/chinese-copywriting-guidelines/" target="_blank" rel="external">中文文案排版指北</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/06/what-is-the-webpack/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dearmadman">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Team.dearmadman.com">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/05/06/what-is-the-webpack/" itemprop="url">what is the webpack</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-06T14:07:09+08:00">
                2016-05-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="什么是webpack"><a href="#什么是webpack" class="headerlink" title="什么是webpack"></a>什么是webpack</h1><h2 id="我们需要了解什么"><a href="#我们需要了解什么" class="headerlink" title="我们需要了解什么"></a>我们需要了解什么</h2><p>下面是需要优先理解的概念：</p>
<ul>
<li>CommonJs</li>
<li>AmdJs</li>
<li>RequireJs</li>
<li>Browserify</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/03/laravel-from-scratch-responses/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dearmadman">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Team.dearmadman.com">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/05/03/laravel-from-scratch-responses/" itemprop="url">laravel 基础教程 —— 响应</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-03T07:11:03+08:00">
                2016-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="HTTP-响应"><a href="#HTTP-响应" class="headerlink" title="HTTP 响应"></a>HTTP 响应</h1><h2 id="基础响应"><a href="#基础响应" class="headerlink" title="基础响应"></a>基础响应</h2><p>所有的路由和控制器都应该返回某种响应发送回给用户的浏览器，laravel提供了多种不同的方式来返回响应。最基本的响应就是简单的在路由或控制器中返回字符串:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Route::get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="string">'Hello World'</span>;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>这里返回的字符串会被laravel自动的转换为HTTP响应发送出去.</p>
<h3 id="响应对象"><a href="#响应对象" class="headerlink" title="响应对象"></a>响应对象</h3><p>大多数时候，路由或者控制器的行为都应该返回<code>Illuminate\Http\Response</code>实例或者<code>view</code>。<code>Response</code>实例允许你便利的对响应头和响应的状态进行定制化.一个<code>Response</code>实例继承自<code>Symfony\Component\HttpFoundation\Response</code>类，该类提供了多种方法来生成一个HTTP响应:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Response</span>;</div><div class="line"></div><div class="line">Route::get(<span class="string">'home'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</div><div class="line">  <span class="keyword">return</span> (<span class="keyword">new</span> Response($content, $status))</div><div class="line">                -&gt;header(<span class="string">'Content-Type'</span>, $value); </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>laravel也提供了便利的<code>response</code>全局帮助函数:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Route::get(<span class="string">'home'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</div><div class="line">  <span class="keyword">return</span> response($content, $status) </div><div class="line">           -&gt;header(<span class="string">'Content-Type'</span>, $value);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<blockquote>
<p>所有可以使用的<code>Response</code>实例的方法，你可以查看 <a href="http://laravel.com/api/master/Illuminate/Http/Response.html" target="_blank" rel="external">API 文档</a> 和 <a href="http://api.symfony.com/3.0/Symfony/Component/HttpFoundation/Response.html" target="_blank" rel="external">Symfony API文档</a>.</p>
</blockquote>
<h3 id="附加响应头"><a href="#附加响应头" class="headerlink" title="附加响应头"></a>附加响应头</h3><p><code>Response</code>实例的大多数方法都是允许进行链式调用的，你可以使用链式调用来流利的构建响应。例如，你可以使用<code>header</code>方法去添加多种响应头在其被发送到用户客户端之前:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> response($content)</div><div class="line">         -&gt;header(<span class="string">'Content-Type'</span>, $type)</div><div class="line">         -&gt;header(<span class="string">'X-Header-One'</span>, <span class="string">'Header Value'</span>)</div><div class="line">         -&gt;header(<span class="string">'X-Header-Two'</span>, <span class="string">'Header Value'</span>);</div></pre></td></tr></table></figure>
<p>或者你可以使用<code>withHeaders</code>方法来通过指定的数组添加请求头到响应:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> response($content)</div><div class="line">         -&gt;withHeaders([</div><div class="line">           <span class="string">'Content-Type'</span> =&gt; $type,</div><div class="line">           <span class="string">'X-Header-One'</span> =&gt; <span class="string">'Header Value'</span>,</div><div class="line">           <span class="string">'X-Header-Two'</span> =&gt; <span class="string">'Header value'</span></div><div class="line">         ]);</div></pre></td></tr></table></figure>
<h3 id="添加cookie到响应"><a href="#添加cookie到响应" class="headerlink" title="添加cookie到响应"></a>添加cookie到响应</h3><p><code>Response</code>实例的<code>cookie</code>可以简单的追加cookie信息到响应。例如，你可以使用<code>cookie</code>方法来生成cookie并附加到响应中:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> response($content)</div><div class="line">         -&gt;header(<span class="string">'Content-Type'</span>, $type)</div><div class="line">         -&gt;cookie(<span class="string">'name'</span>, <span class="string">'value'</span>);</div></pre></td></tr></table></figure>
<p><code>cookie</code>方法允许你添加额外的参数来进一步定制化你的cookie属性:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">-&gt;cookie($name, $value, $minutes, $path, $domain, $secure, $httpOnly)</div></pre></td></tr></table></figure>
<p>默认的,laravel中所有的cookie都是经过签证加密的，所以客户端的用户是没办法修改或者解读的.所以如果你想在生成某些cookie时，禁用默认的加密，你需要在<code>App\Http\Middleware\EncreyptCookies</code>中间件的<code>$except</code>属性中进行追加:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">protected</span> $except = [</div><div class="line">  <span class="string">'cookie_name'</span></div><div class="line">];</div></pre></td></tr></table></figure>
<h2 id="其它响应类型"><a href="#其它响应类型" class="headerlink" title="其它响应类型"></a>其它响应类型</h2><p>帮助方法<code>response</code>也可以用来便利的生成其它类型的响应实例，如果你使用<code>response</code>帮助方法不传递任何参数，那么它会返回一个实现了<code>Illuminate\Contracts\Routing\ResponseFactory</code> contract的实例。该契约提供了多种有用的方法来生成响应.</p>
<h3 id="视图响应"><a href="#视图响应" class="headerlink" title="视图响应"></a>视图响应</h3><p>如果你想控制响应的响应头与状态，并且你也需要返回一个视图作为响应的内容，那么你可以使用<code>view</code>方法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> response()</div><div class="line">         -&gt;view(<span class="string">'hello'</span>, $data)</div><div class="line">         -&gt;header(<span class="string">'Content-Type'</span>, $type);</div></pre></td></tr></table></figure>
<p>当然，如果你并不需要定制化响应的状态或者响应头，那么你可以直接使用全局帮助方法<code>view</code>。</p>
<h3 id="JSON响应"><a href="#JSON响应" class="headerlink" title="JSON响应"></a>JSON响应</h3><p><code>json</code>方法会自动的设置响应头的<code>Content-Type</code>为<code>application/json</code>,以及使用<code>json_encode</code>方法将提供的数组转换为JSON:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> response()-&gt;json([<span class="string">'name'</span> =&gt; <span class="string">'Abigail'</span>, <span class="string">'state'</span> =&gt; <span class="string">'CA'</span>]);</div></pre></td></tr></table></figure>
<p>如果你想要生成<code>jsonp</code>的响应，那么你可以使用<code>json</code>方法然后附加<code>setCallback</code>方法:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> response()</div><div class="line">         -&gt;json([<span class="string">'name'</span> =&gt; <span class="string">'Abigail'</span>, <span class="string">'state'</span> =&gt; <span class="string">'CA'</span>])</div><div class="line">         -&gt;setCallback($request-&gt;input(<span class="string">'callback'</span>));</div></pre></td></tr></table></figure>
<h3 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h3><p><code>download</code>方法可以在返回一个强制用户端浏览器进行下载指定路径文件的响应。<code>download</code>方法也允许传递第二个参数作为浏览器下载时的文件名,你也可以传递http响应头数组作为第三个参数:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> response()-&gt;download($pathToFile);</div><div class="line"></div><div class="line"><span class="keyword">return</span> response()-&gt;download($pathToFile, $name, $headers);</div></pre></td></tr></table></figure>
<blockquote>
<p>注意：Symfony HttpFoundation需要被下载的文件有一个ASCII文件名</p>
</blockquote>
<h3 id="文件响应"><a href="#文件响应" class="headerlink" title="文件响应"></a>文件响应</h3><p><code>file</code>方法允许你在浏览器直接显示image或pdf类型的文件来代替直接下载。该方法接收文件路径作为第一个参数，也可以接收HTTP响应头数组作为第二个参数:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> response()-&gt;file($pathToFile);</div><div class="line"></div><div class="line"><span class="keyword">return</span> response()-&gt;file($pathToFile, $headers);</div></pre></td></tr></table></figure>
<h2 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h2><p>重定向响应是一个<code>Illuminate\Http\RedirectResponse</code>类的实例，它包含了所有重定向到指定URI所需要的响应头信息。laravel提供了多种方式去生成重定向实例.最简单的方式莫过于使用全局帮助方法<code>redirect</code>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Route::get(<span class="string">'dashboard'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</div><div class="line">  <span class="keyword">return</span> redirect(<span class="string">'home/dashboard'</span>); </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>有时候你需要将用户重定向到上一次请求的地址，那么你可以使用全局帮助方法<code>back</code>。因为这里用到了session，所以你必须要保证你的路由使用了session中间件，默认的laravel的路由都被包裹在<code>web</code>路由组中，<code>web</code>中间件组中已经包含了session中间件:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Route::post(<span class="string">'user/profile'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</div><div class="line">  <span class="comment">// Validate the request...</span></div><div class="line"></div><div class="line">  <span class="keyword">return</span>  back()-&gt;withInput();</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="重定向至命名路由"><a href="#重定向至命名路由" class="headerlink" title="重定向至命名路由"></a>重定向至命名路由</h3><p>当你使用<code>redirect</code>方法而不传递任何参数时，laravel将返回<code>Illuminated\Routing\Redirector</code>的一个实例，该实例允许你使用一些方法来处理重定向信息,例如，为了生成重定向到命名路由，你可以使用<code>route</code>方法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> redirect()-&gt;route(<span class="string">'login'</span>);</div></pre></td></tr></table></figure>
<p>如果命名路由也含有参数，那么你可以传递第二个参数到<code>route</code>方法:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> redirect()-&gt;route(<span class="string">'profile'</span>, [<span class="string">'id'</span> =&gt; <span class="number">1</span>]);</div></pre></td></tr></table></figure>
<p>如果你需要重定向的路由是使用<code>Eloquent</code>模型的<code>id</code>作为参数识别的路由,那么你可以直接在<code>route</code>方法中传递用户实例，它会自动被解析到id：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> redirect()-&gt;route(<span class="string">'profile'</span>, [$user]);</div></pre></td></tr></table></figure>
<h3 id="重定向至控制器行为"><a href="#重定向至控制器行为" class="headerlink" title="重定向至控制器行为"></a>重定向至控制器行为</h3><p>你也可以生成重定向信息到控制器的某个行为.你可以简单的通过<code>action</code>方法传递控制器名称和控制器行为来做到这些.你应该注意，你并不需要特别的指出控制器的全部命名空间,因为laravel的<code>RouteServiceProvider</code>已经自动的设置了默认的命名空间:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> redirect()-&gt;action(<span class="string">'HomeController@index'</span>);</div></pre></td></tr></table></figure>
<p>当然，如果你的控制器行为也接收其他的参数，你同样可以在<code>action</code>方法中传递第二个参数:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> redirect()-&gt;action(<span class="string">'UserController@profile'</span>, [<span class="string">'id'</span> =&gt; <span class="number">1</span>]);</div></pre></td></tr></table></figure>
<h3 id="重定向并闪存session"><a href="#重定向并闪存session" class="headerlink" title="重定向并闪存session"></a>重定向并闪存session</h3><p>你可以通过<code>RedirectResponse</code>实例的链式调用来做到在生成重定向信息的同时闪存seession数据，这在执行行为之后存储消息状态的场景尤其有用:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Route::post(<span class="string">'user/profile'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</div><div class="line">  <span class="comment">// Update the user's profile...</span></div><div class="line"></div><div class="line">  <span class="keyword">return</span> redirect(<span class="string">'dashboard'</span>)-&gt;with(<span class="string">'status'</span>, <span class="string">'profile updated'</span>); </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>当然，在用户重定向到新页面时，你是可以访问到闪存的会话信息的，例如，在blade模板中，你可以这么使用:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">@<span class="keyword">if</span> (session(<span class="string">'status'</span>)) </div><div class="line">  &lt;div class="alert alert-success"&gt;</div><div class="line">    &#123;&#123; session(<span class="string">'status'</span>)&#125;&#125;</div><div class="line">  &lt;/div&gt;</div><div class="line">@<span class="keyword">endif</span></div></pre></td></tr></table></figure>
<h2 id="响应宏"><a href="#响应宏" class="headerlink" title="响应宏"></a>响应宏</h2><p>如果你想自定义某种可复用的响应，你可以使用<code>Response</code> facade的 <code>macro</code>方法或者提供<code>Illuminate\Contracts\Routing\ResponseFactory</code>的一个实现:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Providers</span>;</div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">Response</span>;</div><div class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">ServiceProvider</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ResponseMacroServiceProvider</span> <span class="keyword">extends</span> <span class="title">ServiceProvider</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">boot</span><span class="params">()</span> </span>&#123;</div><div class="line">    Response::macro(<span class="string">'caps'</span>, <span class="function"><span class="keyword">function</span> <span class="params">($value)</span> </span>&#123;</div><div class="line">      <span class="keyword">return</span> Response::make(strtoupper($value));</div><div class="line">    &#125;); </div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>macro</code>方法接收一个别名作为第一个参数，接收一个闭包作为第二个参数。闭包会在访问<code>ResponseFactory</code>实现的实例的动态属性<code>macro</code>别名时执行，或者通过全局帮助方法<code>response</code>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> response()-&gt;caps(<span class="string">'foo'</span>);</div></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/02/laravel-from-scratch-requests/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dearmadman">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Team.dearmadman.com">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/05/02/laravel-from-scratch-requests/" itemprop="url">laravel 基础教程 —— 请求</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-02T13:42:16+08:00">
                2016-05-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="HTTP请求"><a href="#HTTP请求" class="headerlink" title="HTTP请求"></a>HTTP请求</h1><h2 id="访问请求"><a href="#访问请求" class="headerlink" title="访问请求"></a>访问请求</h2><p>为了通过依赖注入能够方便的获取http请求实例，你应该在控制器的构造函数或者控制函数中写入类型声明<code>Illuminate\Http\Request</code>。当前请求的实例会自动的从服务容器中注入:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>;</div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserController</span> <span class="keyword">extends</span> <span class="title">Controller</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">store</span> <span class="params">(Request $request)</span> </span>&#123;</div><div class="line">    $name = $request-&gt;input(<span class="string">'name'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果你的控制器方法也需要接收来自路由的参数，那么你需要在进行依赖注入的参数之后添加要接收的参数。例如，你的路由是这么定义的：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Route::put(<span class="string">'user/&#123;id&#125;'</span>, <span class="string">'UserController@update'</span>);</div></pre></td></tr></table></figure>
<p>那么你应该先声明依赖注入<code>Illuminate\Http\Reqeust</code>,然后再按序的传递路由参数:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>;</div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserController</span> <span class="keyword">extends</span> <span class="title">Controller</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span> <span class="params">(Request $request, $id)</span> </span>&#123;</div><div class="line">    <span class="comment">// </span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="基础的请求信息"><a href="#基础的请求信息" class="headerlink" title="基础的请求信息"></a>基础的请求信息</h3><p><code>Illuminate\Http\Request</code>的实例为你的应用提供了多种检查HTTP请求的方法，它继承自<code>Symfony\Component\HttpFoundation\Request</code>。这里列举了一些常用的方法:</p>
<h4 id="检索请求的URI"><a href="#检索请求的URI" class="headerlink" title="检索请求的URI"></a>检索请求的URI</h4><p><code>path</code>方法返回请求的URI.所以，当请求的目标地址是<code>http://domain.com/foo/bar</code>时，<code>path</code>方法将返回<code>foo/bar</code>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$uri = $request-&gt;path();</div></pre></td></tr></table></figure>
<p><code>is</code>方法允许你来效验所请求的URI是否匹配所提供的模式。你可以使用 <code>*</code>字符来作为通配符:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ($request-&gt;is(<span class="string">'admin/*'</span>)) &#123;</div><div class="line">  <span class="comment">//</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果你想得到请求的完整路径，那么你可以使用 <code>url</code> 或 <code>fullUrl</code> 方法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Without Query String...</span></div><div class="line"></div><div class="line">$url = $request-&gt;url();</div><div class="line"></div><div class="line"><span class="comment">// With Query String...</span></div><div class="line"></div><div class="line">$url = $request-&gt;fullUrl();</div></pre></td></tr></table></figure>
<p>你也可以在获取完整请求路径的同时追加请求的参数信息，例如，如果请求的目标是 <code>http://domain.com/foo</code>, 下面的方法将返回<code>http://domain.com/foo?bar=baz</code>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$url = $request-&gt;fullUrlWithQuery([<span class="string">'bar'</span> =&gt; <span class="string">'baz'</span>]);</div></pre></td></tr></table></figure>
<h4 id="检索请求的方式"><a href="#检索请求的方式" class="headerlink" title="检索请求的方式"></a>检索请求的方式</h4><p><code>method</code>方法将返回HTTP请求的方式。你也可以使用<code>isMethod</code>方法来进行http请求方式的匹配效验:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$method = $request-&gt;method();</div><div class="line"></div><div class="line"><span class="keyword">if</span> ($request-&gt;isMethod(<span class="string">'post'</span>)) &#123;</div><div class="line">  <span class="comment">//</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="PSR-7-请求"><a href="#PSR-7-请求" class="headerlink" title="PSR-7 请求"></a>PSR-7 请求</h3><p><a href="http://www.php-fig.org/psr/psr-7/" target="_blank" rel="external">PSR-7</a>标准为http指定了一些消息接口，包括请求和响应.如果你想获得PSR-7请求的实例，你需要先安装一些支持库，laravel使用了 Symfon HTTP Bridge 组件来转换典型的laravel请求和响应为PSR-7兼容的实现:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">composer <span class="keyword">require</span> symfony/psr-http-message-bridge</div><div class="line"></div><div class="line">composer <span class="keyword">require</span> zendframework/zend-diactoros</div></pre></td></tr></table></figure>
<p>一旦你安装了这些库，你就可以简单在你的路由或控制器中使用类型提示来获取PSR-7请求:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">use</span> <span class="title">Psr</span>\<span class="title">Http</span>\<span class="title">Message</span>\<span class="title">ServerRequestInterface</span>;</div><div class="line"></div><div class="line">Route::get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(ServerRequestInterface $request)</span> </span>&#123;</div><div class="line">  <span class="comment">// </span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>如果路由或控制器返回的是PSR-7响应的实例， 那么它会自动的转换为laravel响应实例。</p>
<h2 id="获取输入值"><a href="#获取输入值" class="headerlink" title="获取输入值"></a>获取输入值</h2><h3 id="获取输入的值"><a href="#获取输入的值" class="headerlink" title="获取输入的值"></a>获取输入的值</h3><p>你可以通过<code>Illuminate\Http\Request</code>实例的一些方法来简便的获取用户的输入值.而且你并不需要去关心用户所使用的HTTP请求方式，你可以通过<code>input</code>方法获取所有请求方式的值:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$name = $request-&gt;input(<span class="string">'name'</span>);</div></pre></td></tr></table></figure>
<p>你也可以传递第二个参数到<code>input</code>方法，如果该值并不存在于请求中，将作为默认值返回:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$name = $request-&gt;input(<span class="string">'name'</span>, <span class="string">'Sally'</span>);</div></pre></td></tr></table></figure>
<p>当表单提交的一些输入值是数组时,你可以使用<code>.</code>操作符来访问请求中的数组值:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$name = $request-&gt;input(<span class="string">'products.0.name'</span>);</div><div class="line"></div><div class="line">$names = $request-&gt;input(<span class="string">'products.*.name'</span>);</div></pre></td></tr></table></figure>
<h3 id="获取JSON请求的输入值"><a href="#获取JSON请求的输入值" class="headerlink" title="获取JSON请求的输入值"></a>获取JSON请求的输入值</h3><p>你同样可以使用input方法来访问json请求，只要json请求被设置了正确的请求头 <code>Content-Type: application/json</code>， 那么你就可以使用 <code>.</code> 语法来深入访问json中的数组:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$name = $request-&gt;input(<span class="string">'user.name'</span>);</div></pre></td></tr></table></figure>
<h3 id="判断输入值是否存在"><a href="#判断输入值是否存在" class="headerlink" title="判断输入值是否存在"></a>判断输入值是否存在</h3><p>你可以使用<code>has</code>方法来判断，请求中是否包含了用户的某个输入值,如果该值不是空的字符串，那么<code>has</code>方法就会返回<code>true</code>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ($request-&gt;has(<span class="string">'name'</span>)) &#123;</div><div class="line">  <span class="comment">//</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="获取所有的输入值"><a href="#获取所有的输入值" class="headerlink" title="获取所有的输入值"></a>获取所有的输入值</h3><p>你可以使用<code>all</code>方法来获取所有的用户输入值, 该方法返回包含所有用户值的数组:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$input = $request-&gt;all();</div></pre></td></tr></table></figure>
<h3 id="获取部分输入值"><a href="#获取部分输入值" class="headerlink" title="获取部分输入值"></a>获取部分输入值</h3><p>你可以使用<code>only</code>或者<code>except</code>方法来获取部分输入值, 这两个方法都接收一个单独的数组或者动态的参数列表:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$input = $request-&gt;only([<span class="string">'username'</span>, <span class="string">'password'</span>]);</div><div class="line"></div><div class="line">$input = $request-&gt;only(<span class="string">'username'</span>, <span class="string">'password'</span>);</div><div class="line"></div><div class="line">$input = $request-&gt;except([<span class="string">'credit_card'</span>]);</div><div class="line"></div><div class="line">$input = $request-&gt;except(<span class="string">'credit_card'</span>);</div></pre></td></tr></table></figure>
<h3 id="动态属性"><a href="#动态属性" class="headerlink" title="动态属性"></a>动态属性</h3><p>你可以通过<code>Illuminat\Http\Request</code>的实例的动态属性来获取用户的输入值.如果你的应用表单中存在<code>name</code>字段，你可以通过下面的方式来获取该请求字段:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$name = $request-&gt;name;</div></pre></td></tr></table></figure>
<p>当使用动态属性时，laravel会首先查找请求中是否包含该值，然后才会检索路由中的参数.</p>
<h2 id="旧的输入"><a href="#旧的输入" class="headerlink" title="旧的输入"></a>旧的输入</h2><p>laravel允许你在下一次请求期间保持该次请求的输入。这种特性在表单验证出错时尤其有用，它可以使你复用上一次的请求进行自动的填充。如果你使用了laravel的验证服务，那么你不需要手动的调用它们，因为laravel内置的验证机制会自动的调用它们。</p>
<h3 id="闪存输入到会话"><a href="#闪存输入到会话" class="headerlink" title="闪存输入到会话"></a>闪存输入到会话</h3><p><code>Illuminate\Http\Request</code>实例的<code>flash</code>方法会闪存当前请求的输入到会话中，这样可以使应用在接受用户的下次请求时进行复用:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$request-&gt;flash();</div></pre></td></tr></table></figure>
<p>你也可以使用<code>flashOnly</code>和 <code>flashExcept</code> 方法来闪存部分请求输入到会话：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$request-&gt;flashOnly([<span class="string">'username'</span>, <span class="string">'email'</span>]);</div><div class="line"></div><div class="line">$request-&gt;flashExcept(<span class="string">'password'</span>);</div></pre></td></tr></table></figure>
<h3 id="闪存输入到会话接着跳转"><a href="#闪存输入到会话接着跳转" class="headerlink" title="闪存输入到会话接着跳转"></a>闪存输入到会话接着跳转</h3><p>一个常用的场景就是你需要连同用户的输入一起返回到上一页中，那么你可以使用<code>withInput</code>链式方法:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> redirect(<span class="string">'form'</span>)-&gt;withInput();</div><div class="line"></div><div class="line"><span class="keyword">return</span> redirect(<span class="string">'form'</span>)-&gt;withInput($request-&gt;except(<span class="string">'password'</span>));</div></pre></td></tr></table></figure></p>
<h3 id="获取旧输入"><a href="#获取旧输入" class="headerlink" title="获取旧输入"></a>获取旧输入</h3><p>你可以使用<code>old</code>方法来获取上一次请求所闪存的用户请求：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$username = $request-&gt;old(<span class="string">'username'</span>);</div></pre></td></tr></table></figure>
<p>laravel提供了全局<code>old</code>帮助方法。你也可以在blade模板中使用该方法，如果上次请求未闪存该输入，则会返回<code>null</code>:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input <span class="attribute">type</span>=<span class="string">"text"</span> <span class="attribute">name</span>=<span class="string">"username"</span> <span class="attribute">value</span>=<span class="string">"&#123;&#123; old('username') &#125;&#125;"</span>&gt;</div></pre></td></tr></table></figure>
<h2 id="Cookies"><a href="#Cookies" class="headerlink" title="Cookies"></a>Cookies</h2><h3 id="从请求中检索cookie"><a href="#从请求中检索cookie" class="headerlink" title="从请求中检索cookie"></a>从请求中检索cookie</h3><p>在laravel中所有的cookie在被创建时都会经过一个认证码进行签证加密，这就意味着laravel会验证客户端对cookie的修改.你可以使用<code>Illuminate\Http\Request</code>实例的<code>cookie</code>方法来获取<code>cookie</code>值:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$value = $request-&gt;cookie(<span class="string">'name'</span>);</div></pre></td></tr></table></figure>
<h3 id="在响应中附加一个新的cookie"><a href="#在响应中附加一个新的cookie" class="headerlink" title="在响应中附加一个新的cookie"></a>在响应中附加一个新的cookie</h3><p>laravel提供了一个全局的<code>cookie</code>帮助方法用来生成一个<code>Symfony\Component\HttpFoundation\Cookie</code>实例，该实例可以被<code>Illuminate\Http\Response</code>实例的<code>withCookie</code>附加:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$response = <span class="keyword">new</span> Illuminate\Http\Response(<span class="string">'Hello World'</span>);</div><div class="line"></div><div class="line">$response-&gt;withCookie(<span class="string">'name'</span>, <span class="string">'value'</span>, $minutes);</div><div class="line"></div><div class="line"><span class="keyword">return</span> $response;</div></pre></td></tr></table></figure>
<p>你可以使用<code>cookie</code>方法来创建一个长达5年的长cookie，它要求你使用不带参数的<code>cookie</code>帮助方法直接调用<code>forever</code>方法:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$response-&gt;withCookie(cookie()-&gt;forever(<span class="string">'name'</span>, <span class="string">'value'</span>));</div></pre></td></tr></table></figure>
<h2 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h2><h3 id="获取上传的文件"><a href="#获取上传的文件" class="headerlink" title="获取上传的文件"></a>获取上传的文件</h3><p>你可以通过<code>Illuminate\Http\Request</code>的<code>file</code>方法来访问上传的文件。该方法会返回一个<code>Symfony\Component\HttpFoundation\File\UploadedFile</code>类的实例，它继承自<code>SplFileInfo</code>，提供了多种与文件交互的方法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$file = $request-&gt;file(<span class="string">'photo'</span>);</div></pre></td></tr></table></figure>
<p>你可以使用<code>hasFile</code>方法来判断文件在请求中是否存在:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ($request-&gt;hasFile(<span class="string">'photo'</span>)) &#123;</div><div class="line">  <span class="comment">// </span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="验证文件是否上传成功"><a href="#验证文件是否上传成功" class="headerlink" title="验证文件是否上传成功"></a>验证文件是否上传成功</h3><p>你可以使用<code>isValid</code>方法来验证文件上传的过程中是否出错:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ($request-&gt;file(<span class="string">'photo'</span>)-&gt;isValid()) &#123;</div><div class="line">  <span class="comment">//</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="移动上传的文件"><a href="#移动上传的文件" class="headerlink" title="移动上传的文件"></a>移动上传的文件</h3><p>你可以使用<code>move</code>方法来将上传的文件从临时目录中迁移到指定的目录中:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$request-&gt;file(<span class="string">'photo'</span>)-&gt;move($destinationPath);</div><div class="line"></div><div class="line">$request-&gt;file(<span class="string">'photo'</span>)-&gt;move($destinationPath, $fileName);</div></pre></td></tr></table></figure>
<h3 id="其他文件方法"><a href="#其他文件方法" class="headerlink" title="其他文件方法"></a>其他文件方法</h3><p><code>UploadedFile</code>还有其他许多可用的方法，你可以查看 <a href="http://api.symfony.com/3.0/Symfony/Component/HttpFoundation/File/UploadedFile.html" target="_blank" rel="external">该类的API文档</a> 来了解更多.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/02/laravel-from-scratch-controllers/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dearmadman">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Team.dearmadman.com">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/05/02/laravel-from-scratch-controllers/" itemprop="url">laravel 基础教程 —— 控制器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-02T08:49:43+08:00">
                2016-05-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="HTTP-控制器"><a href="#HTTP-控制器" class="headerlink" title="HTTP 控制器"></a>HTTP 控制器</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>控制器允许你将相应的路由业务逻辑封装在控制器类中进行有效的管理，这样你不必将所有的路由逻辑集中到<code>routes.php</code>文件中，导致代码的臃肿与难以维护。<br>所有的控制器类都被存储在<code>app/Http/Controllers</code>目录中.</p>
<h2 id="基本控制器"><a href="#基本控制器" class="headerlink" title="基本控制器"></a>基本控制器</h2><p>一个基本的控制器应该继承自<code>App\Http\Controllers\Controller</code>控制器类:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>;</div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">User</span>;</div><div class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>\<span class="title">Controller</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserController</span> <span class="keyword">extends</span> <span class="title">Controller</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showProfile</span><span class="params">($id)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> view(<span class="string">'user.profile'</span>, [<span class="string">'user'</span> =&gt; User::findOrFail($id)]);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">`</div></pre></td></tr></table></figure>
<p>我们可以通过下面的方式把控制器的行为分配到路由:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Route::get(<span class="string">'user/&#123;id&#125;'</span>, <span class="string">'UserController@showProfile'</span>);</div></pre></td></tr></table></figure>
<p>一旦将控制器的行为分配到路由之后，每次客户端请求该路由，都会触发控制器的行为。这里即客户端每次请求<code>user/{id}</code>路由，<code>showProfile</code>方法都会被执行，路由中的参数也会被直接传递到该方法中.</p>
<h3 id="控制器-amp-命名空间"><a href="#控制器-amp-命名空间" class="headerlink" title="控制器 &amp; 命名空间"></a>控制器 &amp; 命名空间</h3><p>你应该知道我们在定义控制器路由时是不需要指定控制器的命名空间的，而只需要指定到类名就可以了，这是因为在<code>RouteServiceProvider</code>文件中自动加载的<code>routes.php</code>文件已经被指定了路由组的根命名空间<code>App\Http\Controllers</code>;</p>
<p>如果你想在<code>App\Http\Controllers</code>目录下使用php命名空间来嵌套或组织控制器，那么你只需要简单的指定相对于<code>App\Http\Controllers</code>部分的类名就可以了。所以如果你的控制器的全部类名为<code>App\Http\Controllers\Photos\AdminController</code>,那么你就可以这样来定义控制器路由:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Route::get(<span class="string">'foo'</span>, <span class="string">'Photos\AdminController@method'</span>);</div></pre></td></tr></table></figure>
<h3 id="命名控制器路由"><a href="#命名控制器路由" class="headerlink" title="命名控制器路由"></a>命名控制器路由</h3><p>就像定义命名路由一样，我们也可以给一个控制器路由命名：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Route::get(<span class="string">'foo'</span>, [<span class="string">'uses'</span> =&gt; <span class="string">'FooController@method'</span>, <span class="string">'as'</span> =&gt; <span class="string">'name'</span>]);</div></pre></td></tr></table></figure>
<p>一旦你为一个路由进行了命名， 那么你就可以通过<code>route</code>帮助方法去快速的生成被命名路由的资源表述地址:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span><span class="bash">url = route(<span class="string">'name'</span>);</span></div></pre></td></tr></table></figure>
<h2 id="控制器中间件"><a href="#控制器中间件" class="headerlink" title="控制器中间件"></a>控制器中间件</h2><p>中间件可以这样被分配到控制器路由中:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Route::get(<span class="string">'profile'</span>, [</div><div class="line">  <span class="string">'middleware'</span> =&gt; <span class="string">'auth'</span>,</div><div class="line">  <span class="string">'uses'</span> =&gt; <span class="string">'UserController@showProfile'</span></div><div class="line">]);</div></pre></td></tr></table></figure>
<p>当然你也可以在控制器类中直接使用<code>middleware</code>方法来进行中间件的分配，你也可以只允许类中的某些行为受到指定中间件的约束:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserController</span> <span class="keyword">extends</span> <span class="title">Controller</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">$this</span>-&gt;middleware(<span class="string">'auth'</span>);</div><div class="line"></div><div class="line">    <span class="keyword">$this</span>-&gt;middleware(<span class="string">'log'</span>, [<span class="string">'only'</span> =&gt; [</div><div class="line">      <span class="string">'fooAction'</span>,</div><div class="line">      <span class="string">'barAction'</span></div><div class="line">    ]]);</div><div class="line"></div><div class="line">    <span class="keyword">$this</span>-&gt;middleware(<span class="string">'subscribed'</span>, [<span class="string">'except'</span> =&gt; [</div><div class="line">      <span class="string">'fooAction'</span>,</div><div class="line">      <span class="string">'barAction'</span></div><div class="line">    ]]);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="RESTful-资源控制器"><a href="#RESTful-资源控制器" class="headerlink" title="RESTful 资源控制器"></a>RESTful 资源控制器</h2><p>资源控制器可以使你快速的构建RESTful型的控制器。你可以使用artisan命令来快速的创建:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">php artisan make:controller PhotoController --resource</div></pre></td></tr></table></figure>
<p>该命令会生成<code>app\Http\Controllers\PhotoController.php</code>文件，资源控制器中将包含每个可用的资源操作相应的方法.</p>
<p>你可以通过下面的方式来进行资源路由的注册:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Route::resource(<span class="string">'photo'</span>, <span class="string">'PhotoController'</span>);</div></pre></td></tr></table></figure>
<p>这一个简单的声明会创造多条路由用来处理RESTful式的请求.相应的通过命令生成的资源型控制器也为这些请求设置了对应的处理方法.</p>
<h3 id="资源控制器所处理的行为"><a href="#资源控制器所处理的行为" class="headerlink" title="资源控制器所处理的行为"></a>资源控制器所处理的行为</h3><table>
<thead>
<tr>
<th style="text-align:left">请求方式</th>
<th style="text-align:left">路由地址</th>
<th style="text-align:left">控制器行为</th>
<th style="text-align:left">路由命名</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">GET</td>
<td style="text-align:left"><code>/photo</code></td>
<td style="text-align:left">index</td>
<td style="text-align:left">photo.index</td>
</tr>
<tr>
<td style="text-align:left">GET</td>
<td style="text-align:left"><code>/photo/create</code></td>
<td style="text-align:left">create</td>
<td style="text-align:left">photo.create</td>
</tr>
<tr>
<td style="text-align:left">POST</td>
<td style="text-align:left"><code>/photo</code></td>
<td style="text-align:left">store</td>
<td style="text-align:left">photo.store</td>
</tr>
<tr>
<td style="text-align:left">GET</td>
<td style="text-align:left"><code>/photo/{photo}</code></td>
<td style="text-align:left">show</td>
<td style="text-align:left">photo.show</td>
</tr>
<tr>
<td style="text-align:left">GET</td>
<td style="text-align:left"><code>/photo/{photo}/edit</code></td>
<td style="text-align:left">edit</td>
<td style="text-align:left">photo.edit</td>
</tr>
<tr>
<td style="text-align:left">PUT/PATCH</td>
<td style="text-align:left"><code>/photo/{photo}</code></td>
<td style="text-align:left">update</td>
<td style="text-align:left">photo.update</td>
</tr>
<tr>
<td style="text-align:left">DELETE</td>
<td style="text-align:left"><code>/photo/{photo}</code></td>
<td style="text-align:left">destroy</td>
<td style="text-align:left">photo.destroy</td>
</tr>
</tbody>
</table>
<h3 id="部分资源路由"><a href="#部分资源路由" class="headerlink" title="部分资源路由"></a>部分资源路由</h3><p>有时候你可能并不想控制器处理全部的请求方式，那么你可以这么做：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Route::resource(<span class="string">'photo'</span>, <span class="string">'PhotoController'</span>, [<span class="string">'only'</span> =&gt; [</div><div class="line">  <span class="string">'index'</span>, <span class="string">'show'</span></div><div class="line">]]);</div><div class="line"></div><div class="line">Route::resource(<span class="string">'photo'</span>, <span class="string">'PhotoController'</span>, [<span class="string">'except'</span> =&gt; [</div><div class="line">  <span class="string">'create'</span>, <span class="string">'store'</span>, <span class="string">'update'</span>, <span class="string">'destroy'</span></div><div class="line">]]);</div></pre></td></tr></table></figure>
<h3 id="命名资源路由"><a href="#命名资源路由" class="headerlink" title="命名资源路由"></a>命名资源路由</h3><p>默认的，所有的资源控制器行为都被进行了相应的路由命名，你可以通过<code>names</code>参数来进行重命名:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Route::resource(<span class="string">'photo'</span>, <span class="string">'PhotoController'</span>, [<span class="string">'names'</span> =&gt; [</div><div class="line">  <span class="string">'create'</span> =&gt; <span class="string">'photo.build'</span></div><div class="line">]]);</div></pre></td></tr></table></figure>
<h3 id="命名资源路由参数"><a href="#命名资源路由参数" class="headerlink" title="命名资源路由参数"></a>命名资源路由参数</h3><p>默认的，资源路由的路由参数都被命名为相应的资源名称，你可以用过<code>parameters</code>参数来进行重命名:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Route::resource(<span class="string">'user'</span>, <span class="string">'AdminUserController'</span>, [<span class="string">'parameters'</span> =&gt; [</div><div class="line">  <span class="string">'user'</span> =&gt; <span class="string">'admin_user'</span></div><div class="line">]]);</div><div class="line"></div><div class="line"><span class="comment">// /user/&#123;admin_user&#125;</span></div></pre></td></tr></table></figure>
<p>有时候你可能希望资源路由的路由参数并不需要像默认的资源名称一样采取复数的形式，那么你可以通过传递<code>parameters</code>的选项设置为<code>singular</code>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Route::resource(<span class="string">'users.photos'</span>, <span class="string">'PhotoController'</span>, [</div><div class="line">  <span class="string">'parameters'</span> =&gt; <span class="string">'singular'</span></div><div class="line">]);</div><div class="line"></div><div class="line"><span class="comment">// /users/&#123;user&#125;/photos/&#123;photo&#125;</span></div></pre></td></tr></table></figure>
<p>另外，你也可以全局设置你的资源路由参数为单数形式或者全局进行资源路由参数的命名映射:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Route::singularResourceParameters();</div><div class="line"></div><div class="line">Route::resourceParameters([</div><div class="line">  <span class="string">'user'</span> =&gt; <span class="string">'person'</span>,</div><div class="line">  <span class="string">'photo'</span> =&gt; <span class="string">'image'</span></div><div class="line">])</div></pre></td></tr></table></figure>
<p>当你对资源路由参数进行定制时，你应该清楚的知道命名的顺序优先级:</p>
<ol>
<li>参数被直接的传递给<code>Route::resource</code></li>
<li>通过 <code>Router::resourceParameters</code> 进行全局参数映射</li>
<li>通过<code>parameters</code>数组选项传递给<code>Route::resource</code> 或者 通过 <code>Route::singularResoureParameters</code> 进行单数形式参数设置</li>
<li>默认行为</li>
</ol>
<h3 id="资源控制器中意外的行为"><a href="#资源控制器中意外的行为" class="headerlink" title="资源控制器中意外的行为"></a>资源控制器中意外的行为</h3><p>如果你必须在资源控制器中添加额外的行为去注册相应的路由，那么你一定要在使用<code>Route::resource</code>之前进行注册,否则该行为很可能会被资源控制器意外的覆盖掉.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Route::get(<span class="string">'photos/popular'</span>, <span class="string">'PhotoController@method'</span>);</div><div class="line"></div><div class="line">Route::resource(<span class="string">'photos'</span>, <span class="string">'PhotoController'</span>);</div></pre></td></tr></table></figure>
<h2 id="依赖注入-amp-控制器"><a href="#依赖注入-amp-控制器" class="headerlink" title="依赖注入 &amp; 控制器"></a>依赖注入 &amp; 控制器</h2><h3 id="构造器注入"><a href="#构造器注入" class="headerlink" title="构造器注入"></a>构造器注入</h3><p>laravel的服务容器支持所有的laravel控制器的解析。由于这个原因，所以你可以在控制器的构造函数中添加你所需要依赖的相应类型提示，这些依赖会被自动的解析并注入进控制器实例.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>;</div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Repositories</span>\<span class="title">UserRepository</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserController</span> <span class="keyword">extends</span> <span class="title">Controller</span> </span>&#123;</div><div class="line">  <span class="keyword">protected</span> $users;</div><div class="line"></div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(UserRepository $users)</span> </span>&#123;</div><div class="line">    <span class="keyword">$this</span>-&gt;users = $users;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>当然，你也被允许添加一些laravel <code>contract</code>的类型提示，只要服务容器能够正确的解析，你都可以被允许添加。</p>
<h3 id="方法注入"><a href="#方法注入" class="headerlink" title="方法注入"></a>方法注入</h3><p>除了在构造函数中进行依赖注入，你也可以在控制器的行为方法中进行依赖注入，比如，将<code>Illuminate\Http\Reqeust</code>实例注入到控制器的store方法中：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>;</div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserController</span> <span class="keyword">extends</span> <span class="title">Controller</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">store</span> <span class="params">(Request $request)</span> </span>&#123;</div><div class="line">    $name = $request-&gt;input(<span class="string">'name'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果你的控制器方法也接收从路由传递过来的参数，那么他们会在其它依赖解析完毕之后被传递，比如你的路由是这么定义的:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Route::put(<span class="string">'user/&#123;id&#125;'</span>, <span class="string">'UserController@update'</span>);</div></pre></td></tr></table></figure>
<p>那么你可以这么修正你的控制器行为,来进行参数的接收:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">controllers</span>;</div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserController</span> <span class="keyword">extends</span> <span class="title">Controller</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span> <span class="params">(Request $request, $id)</span> </span>&#123;</div><div class="line">    <span class="comment">// </span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="缓存路由"><a href="#缓存路由" class="headerlink" title="缓存路由"></a>缓存路由</h2><blockquote>
<p>注意：缓存路由不支持闭包函数定义的路由，如果你想使你的路由被缓存，那么你应该使用控制器来管理你的路由.</p>
</blockquote>
<p>如果你所有的路由都是基于控制器的路由，那么你应该使用laravel推荐的缓存路由，你可以简单的通过artisan命令来缓存所有路由注册到同一个文件里，它会替代<code>routes.php</code>文件被解析，使用这种缓存注册路由的方式在某些情况下注册路由的时间将被大大的减少，从而提高了应用的响应速度。<br>但是每次添加新的路由或者删除路由时，为了使路由生效，你需要重新生成一次缓存路由:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">php artisan route:cache</div></pre></td></tr></table></figure>
<p>你可以通过下面的方式去删除路由缓存：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">php artisan route:clear</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/04/30/laravel-from-scratch-middleware/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dearmadman">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Team.dearmadman.com">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/04/30/laravel-from-scratch-middleware/" itemprop="url">laravel 基础教程 —— 中间件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-04-30T09:36:38+08:00">
                2016-04-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>HTTP 中间件为你的应用提供了一种便利的机制去过滤客户端的请求,比如说laravel中自带的用来验证用户是否已经认证的中间件，如果用户的认证没有通过，那么他将被重定向到登录视图。而如果用户已经通过认证，那么他的请求就会被认证中间件通过，并将请求传递给应用。</p>
<p>中间件可以处理多种任务，不仅仅只是用于验证用户认证。比如你可以创建一个跨同源策略的中间件，用来处理每个请求在被响应前添加正确的响应头，你还可以创造一个日志中间件，在应用被请求时优先记录下请求信息。</p>
<p>Laravel框架本身提供了一些中间件，它们包括维护、认证、csrf保护、session等中间件，这些中间件都被定义在<code>app\Http\Middleware</code>目录中。</p>
<h2 id="定义中间件"><a href="#定义中间件" class="headerlink" title="定义中间件"></a>定义中间件</h2><p>为了创建一个新的中间件，你可以直接使用laravel提供的 <code>make:middleware</code> artisan命令:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">php</span> <span class="selector-tag">artisan</span> <span class="selector-tag">make</span><span class="selector-pseudo">:middleware</span> <span class="selector-tag">AgeMiddleware</span></div></pre></td></tr></table></figure>
<p>这条命令会在<code>app\Http\Middleware</code>目录下创建一个<code>AgeMiddleware.php</code>文件。我们创造这么一个中间件，让只有年龄大于200的路由通过:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Middleware</span>;</div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">Closure</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AgeMiddleware</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span> <span class="params">($request, Closure $next)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> ($request-&gt;get(<span class="string">'age'</span>) &gt; <span class="number">200</span>) &#123;</div><div class="line">      <span class="keyword">return</span> $next($request);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> redirect(<span class="string">'home'</span>); </div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>你可以看到，如果请求中所提供的年龄小于等于200,请求将被直接返回一个重定向信息到客户端，而如果年龄大于200，请求将被中间件继续传递给应用。为了在中间件中将请求转交给应用，你可以使用<code>$next</code>回调函数，并将<code>$request</code>传递进去。</p>
<p>你可以建立一系列的中间件来过滤客户端的请求，这样每一层中间件都可以检查请求，如果通过，则将请求转交到下一层，如果不通过则直接被驳回。</p>
<h3 id="前行-后行-中间件"><a href="#前行-后行-中间件" class="headerlink" title="前行/后行 中间件"></a>前行/后行 中间件</h3><p>其实，在中间件中不仅仅可以定义前行中间件，即在请求被转交到应用之前进行处理的中间件。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> </div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Middleware</span>;</div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">Closure</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BeforeMiddleware</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span> <span class="params">($request, Closure $next)</span> </span>&#123;</div><div class="line">    <span class="comment">// Perform action</span></div><div class="line"></div><div class="line">    <span class="keyword">return</span> $next($request);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>也可以定义优先转交请求给应用的后执行中间件。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?</span> php</div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Middleware</span>;</div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">Closure</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AfterMiddleware</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span> <span class="params">($request, Closure $next)</span> </span>&#123;</div><div class="line">    $response = $next($request);</div><div class="line">    <span class="comment">// Perform action</span></div><div class="line">    <span class="keyword">return</span> $response;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="注册中间件"><a href="#注册中间件" class="headerlink" title="注册中间件"></a>注册中间件</h2><h3 id="全局中间件"><a href="#全局中间件" class="headerlink" title="全局中间件"></a>全局中间件</h3><p>如果你需要一个可以过滤所有请求的中间件，那么你可以注册一个全局中间件。你需要先定义好中间件，然后在<code>app/Http/kernel.php</code>中的<code>$middleware</code>数组属性中进行追加注册。</p>
<h3 id="分配中间件到路由"><a href="#分配中间件到路由" class="headerlink" title="分配中间件到路由"></a>分配中间件到路由</h3><p>如果你想要分配中间件到特定的路由，那么你需要在<code>app/Http/kernel.php</code>文件中<code>$routeMiddleware</code>属性中进行追加注册，在这里你应该定义一个短字符的别名，以便于你在路由分配时快速指定。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Within App\Http\Kernel Class...</span></div><div class="line"></div><div class="line"><span class="keyword">protected</span> $routeMiddleware = [</div><div class="line">  <span class="string">'auth'</span> =&gt; \App\Http\Middleware\Authenticate::class,</div><div class="line">  <span class="string">'auth.basic'</span> =&gt; \App\Http\Middleware\AuthenticateBasicAuth::class,</div><div class="line">  <span class="string">'gust'</span> =&gt; \App\Http\Middleware\RedirectIfAuthenticated::class,</div><div class="line">  <span class="string">'throttle'</span> =&gt; \App\Http\Middleware\ThrottleRequest::class,</div><div class="line">];</div></pre></td></tr></table></figure>
<p>一旦你的中间件被注册在了<code>kernel</code>文件中，那么你就可以在定义路由时使用<code>middleware</code>选项进行中间件分配：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Route::get(<span class="string">'admin/profile'</span>, [<span class="string">'middleware'</span> =&gt; <span class="string">'auth'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</div><div class="line">  <span class="comment">// </span></div><div class="line">&#125;]);</div></pre></td></tr></table></figure>
<p>你可以通过这么做来分配多个中间件:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Route::get(<span class="string">'/'</span>, [<span class="string">'middleware'</span> =&gt; [<span class="string">'first'</span>, <span class="string">'second'</span>], <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</div><div class="line">  <span class="comment">// </span></div><div class="line">&#125;]);</div></pre></td></tr></table></figure>
<p>当然laravel也允许你通过链式方法<code>middleware</code>去进行中间件分配:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Route::get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</div><div class="line"> <span class="comment">// </span></div><div class="line">&#125;)-&gt;middleware([<span class="string">'first'</span>, <span class="string">'second'</span>]);</div></pre></td></tr></table></figure>
<p>事实上，你也可以使用完全类名来进行中间件分配：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Middleware</span>\<span class="title">FooMiddleware</span>;</div><div class="line"></div><div class="line">Route::get(<span class="string">'admin/profile'</span>, [<span class="string">'middleware'</span> =&gt; FooMiddleware::class, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</div><div class="line">  <span class="comment">// </span></div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<h3 id="中间件组"><a href="#中间件组" class="headerlink" title="中间件组"></a>中间件组</h3><p>有时候你可能希望在分配路由时，可以通过一个别名来分配一系列的中间件到路由。你可以在<code>kernel</code>文件中使用<code>$middlewareGroups</code>属性来进行注册.</p>
<p>laravel自带了<code>web</code>和<code>api</code>中间件组:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">protected</span> $middlewareGroups = [</div><div class="line">  <span class="string">'web'</span> =&gt; [</div><div class="line">        \App\Http\Middleware\EncryptCookies::class,</div><div class="line">        \Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse::class,</div><div class="line">        \Illuminate\Session\Middleware\StartSession::class,</div><div class="line">        \Illuminate\View\Middleware\ShareErrorsFromSession::class,</div><div class="line">        \App\Http\Middleware\VerifyCsrfToken::class,</div><div class="line">    ],</div><div class="line"></div><div class="line">    <span class="string">'api'</span> =&gt; [</div><div class="line">        <span class="string">'throttle:60,1'</span>,</div><div class="line">        <span class="string">'auth:api'</span>,</div><div class="line">    ],</div><div class="line">];</div></pre></td></tr></table></figure>
<p>一旦注册了中间件组，你可以使用相同语法去分配中间件组到路由:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Route::get(<span class="string">'/'</span>, [<span class="string">'middleware'</span> =&gt; [<span class="string">'web'</span>], <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</div><div class="line">  <span class="comment">// </span></div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<p>事实上，laravel自带的web中间件组已经被默认启用，所有在<code>routes.php</code>中被定义的路由都被分配了此中间件。你可以在<code>RouteServiceProvider.php</code>文件中进行修改.</p>
<h2 id="带参数的中间件"><a href="#带参数的中间件" class="headerlink" title="带参数的中间件"></a>带参数的中间件</h2><p>中间件也可以接收额外的自定义参数。比如说你可能需要一个中间件来验证已认证的用户的权限问题。你可能需要传递一个角色名称参数来执行相应的行为.那么你需要创建一个<code>RoleMiddleware</code>来接收一个角色名称作为额外的参数.<br>额外的参数将会被传递在<code>$next</code>参数之后:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">namesapce App\Http\Middleware;</div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">Closure</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">RoleMiddleware</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span> <span class="params">($request, Closure $next, $role)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (!$request-&gt;user()-&gt;hasRole($role)) &#123;</div><div class="line">      <span class="comment">// Redirect...</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> $next($request);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>带参数的中间件在分配给路由时需要在中间件别名之后跟<code>:</code>来分割别名和参数，多个参数需要使用<code>,</code>分隔:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Route::post(<span class="string">'post/&#123;id&#125;'</span>, [<span class="string">'middleware'</span> =&gt; <span class="string">'role:editor'</span>, <span class="function"><span class="keyword">function</span> <span class="params">($id)</span> </span>&#123;</div><div class="line">  <span class="comment">// </span></div><div class="line">&#125;]);</div></pre></td></tr></table></figure>
<h2 id="末端中间件"><a href="#末端中间件" class="headerlink" title="末端中间件"></a>末端中间件</h2><p>有时候你可能需要在响应被发送到客户端之后继续处理一些任务，比如说 <code>session</code>中间件在laravel中就是响应被发送出去之后才将session信息进行存储操作。这时候你可以通过在中间件中添加<code>terminate</code>方法来定义一个末端中间件:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">Illuminate</span>\<span class="title">Session</span>\<span class="title">Middleware</span>;</div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">Closure</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">StartSession</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">hanlde</span> <span class="params">($request, Closure $next)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> $next($request);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">terminate</span><span class="params">($request, $response)</span> </span>&#123;</div><div class="line">    <span class="comment">// Store the sessin data...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>terminate</code>方法会接收请求和响应，一旦你定义了一个末端中间件，你应该在<code>kernel</code>文件中将其添加到全局中间件中.</p>
<p>每当中间件中的<code>terminate</code>方法被调用，laravel都会从服务容器中返回一个新的中间件实例，如果你想使用同一个实例，你应该将其注册在服务容器中并使用<code>singleton</code>方法注册.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/8/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/10/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Dearmadman</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">100</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Dearmadman</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
